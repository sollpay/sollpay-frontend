{"version":3,"sources":["lib/routing/index.ts","pages/home/model.ts","models/connection/structs.ts","components/common/Card/Card.tsx","components/common/ModalManager/constants.ts","lib/sollpay/sollpay.ts","models/connection/effects/findSubscriptionPlansFx.ts","models/connection/effects/findSubscriptionsFx.ts","components/common/Subscribe/model.ts","components/common/Subscribe/Subscribe.tsx","components/ui/Select/Select.tsx","api/wallet/LocalWallet.ts","lib/sollpay/utils/send-and-confirm-transaction.ts","models/wallet/index.ts","models/app/index.ts","models/connection/index.ts","pages/home/Home.tsx","pages/notFound/NotFound.tsx","pages/select/Select.tsx","routes.tsx","components/common/ModalManager/ModalManager.tsx","App.tsx","models/app/init.ts","models/connection/effects/createSubscriptionPlanFx.ts","models/connection/effects/createSubscriptionFx.ts","models/connection/effects/findSubscriptionPlanFx.ts","models/connection/effects/getParsedTokenAccountsByOwnerFx.ts","models/wallet/init.ts","models/modals/init.ts","index.tsx","reportWebVitals.ts","api/wallet/index.ts","api/wallet/SolletWallet.ts","lib/sollpay/layout.ts","api/connection/index.ts","api/connection/utils/retryableProxy.ts","api/wallet/Wallet.ts","constants/common.ts","lib/sollpay/layouts/subscriptionPlan.ts","models/modals/index.ts","config/index.ts","lib/sollpay/layouts/subscription.ts","components/ui/Button/Button.tsx","utils/common.ts","components/common/Header/Header.tsx","components/common/MainContainer/MainContainer.tsx"],"names":["history","createBrowserHistory","connectAndCreateClicked","app","createEvent","watch","a","$connected","getState","connectFx","push","AccountInfoResult","struct","executable","owner","lamports","data","rentEpoch","ProgramAccountInfoResult","pubkey","account","GetProgramAccountsRpcResult","resultDescription","jsonRpcVersion","literal","union","jsonrpc","id","error","result","jsonRpcResult","array","Wrapper","Card","className","style","MODAL_PLAN","SollPay","connection","subscriptionPlan","sollPayProgramId","tokenProgramId","token","feeAccount","authority","payer","this","subscriptionPlanAccount","nonce","subscriptionTimeframe","maxAmount","sollPay","publicKey","getMinBalanceRentForExemptSubscriptionPlan","balanceNeeded","transaction","Transaction","add","SystemProgram","createAccount","fromPubkey","newAccountPubkey","space","SubscriptionPlanLayout","span","programId","createSubscriptionPlanInstruction","sendAndConfirmTransaction","recurringPaymentsProgramId","dataLayout","BufferLayout","Layout","Buffer","alloc","encode","instruction","subscription_timeframe","Numberu64","toBuffer","max_amount","keys","isSigner","isWritable","TransactionInstruction","subscriptionAccount","tokenAccount","SYSVAR_CLOCK_PUBKEY","getMinimumBalanceForRentExemption","SubscriptionLayout","findSubscriptionPlansFx","use","getConnection","wallet","getWallet","filters","memcmp","offset","offsetOf","bytes","toBase58","dataSize","_rpcRequest","SOLLPAY_PROGRAM_ID","commitment","encoding","unsafeRes","res","Error","message","assert","map","parsedData","parseSubscriptionPlanData","from","isInitialized","PublicKey","filter","complement","isNil","findSubscriptionsFx","parseSubscriptionData","SubscribeGate","createGate","$subscriptionPlan","createStore","$tokenAccounts","$store","combine","connected","availableTokens","$availableTokens","tokenAccounts","isLoadingPlan","findSubscriptionPlanFx","pending","isLoadingTokenAccounts","getParsedTokenAccountsByOwnerFx","isSubscribing","createSubscriptionFx","isFetching","one","two","three","on","doneData","_","tokens","forward","open","to","guard","source","clock","Boolean","target","WrapperCard","Title","Rocket","Group","Price","SubscribeButton","Subscribe","planAddress","useGate","useStore","tokenMeta","useMemo","b","handleSubscribeClick","isDisabled","classNames","shortAddress","renderSubscriptionTimeframe","onClick","disabled","SelectButton","Value","Placeholder","SelectListContainer","SelectList","SelectOptionText","SelectOption","Select","onChange","useState","selectRef","useRef","selectListRef","handleAwayClick","e","setIsOpen","useEffect","window","selectedItem","items","item","selected","ref","size","color","isOpen","role","nextValue","value","key","isSelected","title","String","LocalWallet","network","isDev","localPrivateKey","Account","JSON","parse","setImmediate","emit","WalletEvent","CONNECT","serializeMessage","signature","nacl","sign","detached","secretKey","addSignature","Promise","resolve","Wallet","signers","realSendAndConfirmTransaction","skipPreflight","preflightCommitment","createEffect","disconnectFx","changeCluster","$cluster","$type","WalletType","SOLLET","cluster","TOKENS","createDomain","AppGate","createSubscriptionPlanFx","Container","Hero","HeroTitle","HeroDescription","ButtonsWrapper","ButtonStyled","ConnectButton","DocumentationButton","GitHubA","Section","SectionContent","SectionColumn","Home","showConnect","primary","href","hollow","NotFound","CardStyled","ColumnLink","LeftColumnLink","LeftPic","Delimiter","RightColumnLink","RightPic","Description","Pages","renderRoutes","isAuth","path","exact","component","needAuth","lazy","route","ModalContainer","ModalWrapper","ModalBackground","modalsMap","Map","ModalManager","modals","closeTopModal","modal","last","modalId","modalRef","modalsRefs","closeModalFx","handleWrapperClick","dialogs","props","ModalComponent","modalType","getReadyDialogs","createRef","setModalsRefs","state","fallback","close","dayjs","extend","relativeTime","localizedFormat","App","onCreateStore","newStore","reset","onCreateEffect","newEffect","failData","payload","console","findProgramAddress","instructions","SOLLPAY_FEE_ACCOUNT","TOKEN_PROGRAM_ID","makeTransaction","sendTransaction","SPLToken","createApproveInstruction","getMinBalanceRentForExemptSubscription","createSubscriptionInstruction","getAccountInfo","info","getParsedTokenAccountsByOwner","mint","type","WalletAPI","DISCONNECT","CONFIRMED","transactionSignature","done","persist","store","promises","dialogInfo","get","delete","closeModal","openModalFx","$modals","some","openModal","promise","set","dialog","concat","createInspector","onPerfEntry","globals","ReactDOM","document","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","DEFAULT_PROVIDER","SolletWallet","provider","solletWallet","SolletWalletAdapter","connect","disconnect","signTransaction","POST_TRANSACTION_SLEEP_MS","postTransactionSleepMS","ERROR_CONNECT_FIRST","createWallet","getNetwork","LOCAL","BONFIDA","newWallet","getRecentBlockhash","recentBlockhash","blockhash","signatures","length","partialSign","defaultSendOptions","DEFAULT_COMMITMENT","awaitConfirmation","log","confirmTransaction","sleep","signed","sendRawTransaction","serialize","property","uint64","currentCluster","defaultRetryOptions","count","intervalMS","backoutMultiplier","LOCALNET_URL","defaultCommitment","createConnection","memoizeWith","identity","Connection","forEach","fnName","fn","retryOptions","options","mergeLeft","retryReducer","thisArg","argArray","previousValue","currentValue","currentIndex","call","apply","catch","sleepMs","Proxy","Array","reduce","retryableProxy","clusterApiUrl","confirmViaSocket","onSignature","signatureResult","confirmViaHttp","race","signedTransaction","SIGNED","EventEmitter","u8","accountInfo","decode","u64","fromBuffer","process","APP_LOCAL_WALLET_PRIVATE_KEY","Number","isApproved","cycleStart","withdrawnAmount","Button","ms","setTimeout","address","slice","Logo","Right","Header","placeholder","MainContainer","children"],"mappings":"0KAEaA,EAAUC,e,uHCGVC,EAA0BC,IAAIC,YAAJ,W,2BAAA,gEAEvCF,EAAwBG,MAAxB,sBAA8B,sBAAAC,EAAA,yDACVC,IAAWC,WADD,gCAGpBC,cAHoB,OAK5BT,IAAQU,KAAK,WALe,6C,8ECY9B,IAAMC,EAAoBC,YAAO,CAC/BC,WAAY,UACZC,MAAO,SACPC,SAAU,SACVC,KAAM,MACNC,UAAW,YAGPC,EAA2BN,YAAO,CACtCO,OAAQ,SACRC,QAAST,IAMEU,EAjCb,SAAuBC,GACrB,IAAMC,EAAiBX,IAAOY,QAAQ,OACtC,OAAOZ,IAAOa,MAAM,CAClBb,YAAO,CACLc,QAASH,EACTI,GAAI,SACJC,MAAO,QAEThB,YAAO,CACLc,QAASH,EACTI,GAAI,SACJC,MAAO,QACPC,OAAQP,MAqB6BQ,CACzClB,IAAOmB,MAAM,CAACb,M,gGChCVc,EAAO,sDAQAC,EAA2C,SAAC,GAInD,IAJmD,EAInD,EAJmD,WAInD,EAJmD,MAGvDC,EACI,EADJA,UAEA,OACE,qBAASC,MAAT,EAAuBD,UAAvB,GACE,I,yCCnBN,kCAAO,IAAME,EAAa,c,mLCiBbC,EAAb,WA2CE,WACEC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACA/B,GACA,yBApDMwB,gBAoDN,OA/CME,sBA+CN,OA1CMC,oBA0CN,OArCMF,sBAqCN,OAhCMG,WAgCN,OA3BMC,gBA2BN,OAtBMC,eAsBN,OAjBMC,WAiBN,OAZM/B,WAYN,EACAgC,KAAKR,WAAaA,EAClBQ,KAAKP,iBAAmBA,EACxBO,KAAKN,iBAAmBA,EACxBM,KAAKL,eAAiBA,EACtBK,KAAKJ,MAAQA,EACbI,KAAKH,WAAaA,EAClBG,KAAKF,UAAYA,EACjBE,KAAKD,MAAQA,EACbC,KAAKhC,MAAQA,EA9DjB,sGAiEE,WACEwB,EACAO,EACAE,EACAH,EACAF,EACAC,EACAH,EACAC,EACAO,EACAlC,EACAmC,EACAC,GAZF,kFAcQC,EAAU,IAAId,EAClBC,EACAS,EAAwBK,UACxBZ,EACAC,EACAC,EACAC,EACAC,EACAC,EACA/B,GAvBJ,SA2B8BuB,EAAQgB,2CAClCf,GA5BJ,cA2BQgB,EA3BR,QA+BQC,EAAc,IAAIC,KACZC,IACVC,IAAcC,cAAc,CAC1BC,WAAYf,EAAMO,UAClBS,iBAAkBd,EAAwBK,UAC1CrC,SAAUuC,EACVQ,MAAOC,IAAuBC,KAC9BC,UAAWzB,KAIfe,EAAYE,IACVpB,EAAQ6B,kCACNnB,EACAH,EACAF,EACAC,EACAF,EACAD,EACA1B,EACAkC,EACAC,EACAC,IArDN,SAyDQiB,YACJ,2CACA7B,EACAiB,EACAV,EACAE,GA9DJ,gCAiESI,GAjET,4CAjEF,4HAqIE,SACEJ,EACAH,EACAF,EACAC,EACAF,EACA2B,EACAtD,EACAkC,EACAC,EACAC,GAEA,IAAMmB,EAAaC,SAAoB,CACrCA,KAAgB,eAChBA,KAAgB,SAChBC,IAAc,0BACdA,IAAc,gBAGVvD,EAAOwD,EAAOC,MAAMJ,EAAWL,MACrCK,EAAWK,OACT,CACEC,YAAa,EACb3B,QACA4B,uBAAwB,IAAIC,IAAU5B,GAAuB6B,WAC7DC,WAAY,IAAIF,IAAU3B,GAAW4B,YAEvC9D,GAGF,IAAMgE,EAAO,CACX,CACE7D,OAAQ4B,EAAwBK,UAChC6B,UAAU,EACVC,YAAY,GAEd,CAAE/D,OAAQL,EAAOmE,UAAU,EAAOC,YAAY,GAC9C,CAAE/D,OAAQyB,EAAWqC,UAAU,EAAOC,YAAY,GAClD,CAAE/D,OAAQuB,EAAOuC,UAAU,EAAOC,YAAY,IAKhD,OAAO,IAAIC,IAAuB,CAChCH,OACAf,UAAWG,EACXpD,WAnLN,2CAuLE,SACEoE,EACArC,EACAsC,EACA5C,EACAE,EACAyB,EACAnB,EACAC,GAEA,IAAMmB,EAAaC,SAAoB,CACrCA,KAAgB,eAChBC,IAAc,0BACdA,IAAc,gBAGVvD,EAAOwD,EAAOC,MAAMJ,EAAWL,MACrCK,EAAWK,OACT,CACEC,YAAa,EACbC,uBAAwB,IAAIC,IAAU5B,GAAuB6B,WAC7DC,WAAY,IAAIF,IAAU3B,GAAW4B,YAEvC9D,GAGF,IAAMgE,EAAO,CACX,CACE7D,OAAQiE,EAAoBhC,UAC5B6B,UAAU,EACVC,YAAY,GAEd,CAAE/D,OAAQ4B,EAAyBkC,UAAU,EAAOC,YAAY,GAChE,CAAE/D,OAAQkE,EAAcJ,UAAU,EAAOC,YAAY,GACrD,CAAE/D,OAAQsB,EAAgBwC,UAAU,EAAOC,YAAY,GACvD,CAAE/D,OAAQmE,IAAqBL,UAAU,EAAOC,YAAY,GAC5D,CAAE/D,OAAQwB,EAAYsC,UAAU,EAAOC,YAAY,IAGrD,OAAO,IAAIC,IAAuB,CAChCH,OACAf,UAAWG,EACXpD,WAjON,+FA0OE,WACEsB,GADF,0FAGSA,EAAWiD,kCAChBxB,IAAuBC,OAJ3B,2CA1OF,kJAuPE,WACE1B,GADF,0FAGSA,EAAWiD,kCAChBC,IAAmBxB,OAJvB,2CAvPF,gE,6LCJAyB,IAAwBC,IAAxB,sBAA4B,sCAAApF,EAAA,6DACpBgC,EAAaqD,cACbC,EAASC,cAAY1E,OAErB2E,EAAU,CACd,CACEC,OAAQ,CACNC,OAAQjC,IAAuBkC,SAAS,SACxCC,MAAON,EAAOO,aAGlB,CACEC,SAAUrC,IAAuBC,OAZX,SAgBF1B,EAAW+D,YAAY,qBAAsB,CACnEC,IAAmBH,WACnB,CACEI,WAAYjE,EAAWiE,WACvBT,UACAU,SAAU,YArBY,UAgBpBC,EAhBoB,SAyBpBC,EAAMrF,YAA4BoF,IAChC7E,MA1BkB,sBA2BlB,IAAI+E,MACR,2CACEL,IAAmBH,WACnB,KACAO,EAAI9E,MAAMgF,SA/BU,cAmClB/E,EAAW6E,EAAX7E,OACRgF,IAAyB,qBAAXhF,GApCY,kBAsCnBA,EACJiF,KAAI,SAACjF,GACJgF,IAAkC,WAA3BhF,EAAOT,QAAQJ,KAAK,IAE3B,IAAM+F,EAAaC,YACjBxC,EAAOyC,KAAKpF,EAAOT,QAAQJ,KAAK,GAAI,WAEtC,OAAK+F,EAAWG,cAIT,CACL/F,OAAQ,IAAIgG,IAAUtF,EAAOV,QAC7BC,QAAS,CACPP,WAAYgB,EAAOT,QAAQP,WAC3BC,MAAO,IAAIqG,IAAUtF,EAAOT,QAAQN,OACpCC,SAAUc,EAAOT,QAAQL,SACzBC,KAAM+F,IATD,QAaVK,OAAOC,YAAWC,OA3DK,+C,2LCA5BC,EAAoB7B,IAApB,sBAAwB,oCAAApF,EAAA,6DAChBgC,EAAaqD,cACJE,cAAY1E,OAErB2E,EAAU,CAOd,CACEM,SAAUZ,IAAmBxB,OAZX,SAgBE1B,EAAW+D,YAAY,qBAAsB,CACnEC,IAAmBH,WACnB,CACEI,WAAYjE,EAAWiE,WACvBT,UACAU,SAAU,YArBQ,UAgBhBC,EAhBgB,SAyBhBC,EAAMrF,YAA4BoF,IAChC7E,MA1Bc,sBA2Bd,IAAI+E,MACR,2CACEL,IAAmBH,WACnB,KACAO,EAAI9E,MAAMgF,SA/BM,cAmCd/E,EAAW6E,EAAX7E,OACRgF,IAAyB,qBAAXhF,GApCQ,kBAsCfA,EACJiF,KAAI,SAACjF,GACJgF,IAAkC,WAA3BhF,EAAOT,QAAQJ,KAAK,IAE3B,IAAM+F,EAAaS,YACjBhD,EAAOyC,KAAKpF,EAAOT,QAAQJ,KAAK,GAAI,WAEtC,OAAK+F,EAAWG,cAIT,CACL/F,OAAQ,IAAIgG,IAAUtF,EAAOV,QAC7BC,QAAS,CACPP,WAAYgB,EAAOT,QAAQP,WAC3BC,MAAO,IAAIqG,IAAUtF,EAAOT,QAAQN,OACpCC,SAAUc,EAAOT,QAAQL,SACzBC,KAAM+F,IATD,QAaVK,OAAOC,YAAWC,OA3DC,+C,uRCKXG,EAAgBC,cAEhBC,EAAoBxH,IAAIyH,YACnC,KAD+B,yEAIpBC,EAAiB1H,IAAIyH,YAEhC,GAF4B,sEAIjBE,EAASC,kBAAQ,CAAD,UAAC,CAC5BC,UAAWzH,IACXgC,iBAAkBoF,EAClBM,gBAAiBC,IACjBC,cAAeN,EACfO,cAAeC,IAAuBC,QACtCC,uBAAwBC,IAAgCF,QACxDG,cAAeC,IAAqBJ,QACpCK,WAAYZ,kBAAQ,CAAD,UACjBM,IAAuBC,QACvBI,IAAqBJ,QACrBE,IAAgCF,QAChC,SAACM,EAAKC,EAAKC,GAAX,OAAqBF,GAAOC,GAAOC,IAJlB,2EARQ,qEAgB7BnB,EAAkBoB,GAChBV,IAAuBW,UACvB,SAACC,EAAG1G,GAAJ,OAAyBA,KAG3BsF,EAAekB,GACbP,IAAgCQ,UAChC,SAACC,EAAGC,GAAJ,OAAeA,KAGjBC,kBAAQ,CAAD,SAAC,CACNlC,KAAMQ,EAAc2B,KACpBC,GAAIhB,KAFC,sDAKPiB,gBAAM,CAAD,UAAC,CACJC,OAAQ5B,EAAkBb,KAAI,SAACvE,GAAD,MAAuB,CACnDG,MAAK,OAAEH,QAAF,IAAEA,OAAF,EAAEA,EAAkBvB,KAAK0B,UAEhC8G,MAAOjJ,IACP6G,OAAQ,WAAYY,GAAZ,IAAGtF,EAAH,EAAGA,MAAH,OAA0B+G,QAAQ/G,IAAUsF,GACpD0B,OAAQlB,MANL,sD,IC3CCmB,EAAW,wDAaXC,EAAK,oDAULC,EAAM,qDAyBNC,EAAK,oDAqBLC,EAAK,oDAMLC,EAAe,4DA2BRC,EAAuB,SAAC,GAAoB,IAAlBC,EAAkB,EAAlBA,YACrCC,YAAQ1C,EAAe,CAAEyC,YAAa,IAAI,EAAJ,OADiB,MAWnDE,YATJ,GAAM,EAFiD,EAEjD,YAFiD,EAEjD,mBAFiD,EAEjD,kBAFiD,EAEjD,gBAFiD,EAEjD,gBAFiD,EAEjD,yBAFiD,EAEjD,cAQJzB,EAVqD,EAUrDA,WAGI0B,EAAYC,mBAChB,kBACErC,QACGvF,YAAD,OACEA,wBAAsBH,QAAtBG,IAAsBH,OAAtBG,EAAsBH,aAJL,iBAMvB,CAAC0F,EANH,IASM5C,EAAeiF,mBAAQ,WAC3B,WAAInC,SACF,KAGKA,QACL,qBACE7H,gDACAiK,uCAHGpC,YAAP,KAKC,CAVH,IAYMqC,EAAoB,uCAAG,sBAAAlK,EAAA,yDAC3B,EAD2B,oDAK3B,EAL2B,gCAMnBG,cANmB,UAS3B,EAT2B,iEAarBiI,YAAqB,CACzB3F,wBAAyB,IAAI,EAAJ,EADA,GAEzBsC,aAAcA,EAFW,OAGzBzC,UAAWL,OAHc,UAIzBU,sBAAuBV,6BAJE,WAKzBW,UAAWX,8BAlBc,2CAAH,qDAkEpBkI,GAAclI,GAApB,EAEA,OACE,yBACE,oCACA,qBAAQL,UAAWwI,IAAW,CAAE/B,iBAChC,qBAAOzG,UAAWwI,IAAW,CAAED,gBAjCjC,GAIKpF,GAAL,EAEI,qDACgB,KACJ,OAATgF,QAAS,IAATA,yBACCM,YAAapI,aADf,aAOJ,oCACE,yBACGA,iBAAD,WAA4C,KAClC,OAAT8H,QAAS,IAATA,yBAA0B9H,aAA3B,WAAkE,KAhHxC,SAACU,GACnC,UACE,OACE,cACF,OACE,eACF,QACE,gBACF,SACE,eACF,QACE,UAuGG2H,CACCrI,6BADF,aAnBF,MAmCA,qBAAiBsI,QAAjB,EAAgDC,SAAhD,GApDF,EACE,kBAEF,EACE,oBAEF,EACE,iBAEF,EACE,YAEF,a,0ICpLE9I,EAAO,sDAIP+I,EAAY,6DAwBZC,EAAK,mDAOLC,EAAW,qDAIXC,EAAmB,gEAenBC,EAAU,wDAUVC,EAAgB,gEAShBC,EAAY,0DAiCLC,EAAoB,SAAC,GAK5B,IAL4B,EAK5B,EAL4B,cAK5B,EAL4B,WAK5B,EAL4B,MAIhCC,EACI,EADJA,SACI,EACwBC,oBAA5B,GADI,mBACE,EADF,KACE,EADF,KAEEC,EAAYC,iBAAlB,MACMC,EAAgBD,iBAAtB,MAEME,EAAkB,SAACC,GAAkB,SAEvC,UAACJ,iBAAD,aAACA,WAA4BI,EAA7B,WACA,UAACF,iBAAD,aAACA,WAAgCE,EAFnC,UAIEC,OAIJC,qBAAU,WAGR,OAFAC,mCAEO,WACLA,yCAJJD,IAQA,IAAME,EAAe3B,mBACnB,kBAAM4B,QAAYC,YAAD,OAAUA,UADD,OAE1B,CAACC,EAFH,IAcA,OACE,yBACE,qBAAcC,IAAd,EAA8BxB,QAXR,WACxBiB,QAWKG,EACC,yBAAQA,SAAsBA,EADnB,OAGX,yBAHF,GAIE,IACF,uBAAmBK,KAAnB,GAA6BC,MAA7B,aAEDC,EACC,qBAAqBH,IAArB,GACE,qBAAYI,KAAZ,WACGP,OAAU,gBAlBMQ,EAkBL,EAAD,EAAC,MAASC,EAAV,EAAUA,MAAV,OACT,qBACEC,IAAKD,GADP,EAEEF,KAFF,SAGE5B,SAtBa6B,EAmBf,EAnB8C,WACxDnB,KACAO,QAqBY5J,UAAWwI,IAAW,CAAEmC,WAAYF,IAAUP,KAE9C,qBAAkBU,MAAOA,GAASC,OAAlC,IACGD,GAAD,SAXZ,O,8LC1JOE,EAAb,kDAGE,WAAYC,GAAiB,MAE3B,GAF2B,qBAC3B,cAAMA,IAHA7L,aAEqB,GAEtB8L,IACH,MAAM,IAAIvG,MAAM,6CAGlB,IAAKwG,IACH,MAAM,IAAIxG,MAAM,2CAPS,OAU3B,EAAKvF,QAAU,IAAIgM,IAAQC,KAAKC,MAAMH,MAGtCI,GAAa,kBAAM,EAAKC,KAAKC,IAAYC,YAbd,EAH/B,wCAmBE,WACE,OAAO5K,KAAK1B,QAAQgC,YApBxB,wBAwBE,cAxBF,oEA4BE,WAAsBG,GAAtB,iBAAAjD,EAAA,6DACQsG,EAAUrD,EAAYoK,mBACtBC,EAAYC,IAAKC,KAAKC,SAASnH,EAAS9D,KAAK1B,QAAQ4M,WAC3DzK,EAAY0K,aAAanL,KAAK1B,QAAQgC,UAAWoB,EAAOyC,KAAK2G,IAH/D,kBAISM,QAAQC,QAAQ5K,IAJzB,gDA5BF,4DAAiC6K,O,4HCF1B,SAASjK,EACd2I,EACAxK,EACAiB,GAE+B,2BAD5B8K,EAC4B,iCAD5BA,EAC4B,kBAC/B,OAAOC,YAA8BhM,EAAYiB,EAAa8K,EAAS,CACrEE,eAAe,EACfhI,WAAY,SACZiI,oBAAqB,a,mXCVZ/N,EAAYN,IAAIsO,aAAJ,gEAEZC,EAAevO,IAAIsO,aAAJ,oEAEfE,EAAgBxO,IAAIC,YAAJ,qEAEhBwO,EAAWzO,IAAIyH,YAA6B,SAAjC,gEAIXiH,GAFmB1O,IAAIC,YAAJ,uEAEXD,IAAIyH,YAAwBkH,IAAWC,OAAvC,6DAERxO,EAAaJ,IAAIyH,aAAqB,EAAzB,kEAEbM,EAAmB0G,EAAS9H,KAAI,SAACkI,GAAD,OAAaC,IAAOD,IAAY,O,2IClBhE7O,EAAM+O,uBAAa,CAAD,U,2BAAA,6CAElBC,EAAUzH,e,8ZCKVc,EAAkCrI,IAAIsO,aAAJ,uFAOlCW,EAA2BjP,IAAIsO,aAAJ,gFAS3BhJ,EAA0BtF,IAAIsO,aAAJ,8EAK1BpG,EAAyBlI,IAAIsO,aAAJ,6EAKzBlH,EAAsBpH,IAAIsO,aAAJ,2EAKtB/F,EAAuBvI,IAAIsO,aAAJ,4E,6eC/B9BzM,EAAO,sDAOPqN,EAAS,uDAUTC,EAAI,mDAMJC,EAAS,sDAUTC,EAAe,4DAUfC,EAAc,4DASdC,EAAY,yDAKZC,EAAa,wDAIbC,EAAmB,6DASnBC,EAAO,oDAKPC,EAAO,qDAMPlG,EAAK,oDAULmG,EAAc,6DAMdC,EAAa,4DAKNC,EAAO,WAClB,IAAMjI,EAAYoC,YAAlB,KAEA,OACE,yBACE,uBAAQ8F,aAAR,IACA,2BACE,yBACE,yBACE,mDACyB,6BADzB,eAGA,sIAIA,yBACE,qBAAeC,SAAf,EAAuBtF,QAAvB,KACG7C,EAAY,UAAb,uBAEF,uBAAGoI,KAAH,KACE,qBAAqBC,QAArB,sBAGJ,qBAASD,KAAT,gBAGF,yBACE,iCACA,yBACE,uBAAWlG,YAAX,iDACA,yBACE,6I,WC9IHoG,EAAW,kBAAM,gD,iBCOxBtO,EAAO,sDAIPqN,EAAS,wDAOTkB,EAAU,sDAOVC,EAAU,sDAWVC,EAAc,wDAEdC,EAAO,qDAQPC,EAAS,wDAMTC,EAAe,yDAEfC,EAAQ,uDAQRjH,EAAK,mDAULkH,GAAW,yDAQJxF,GAAa,WACxB,OACE,yBACE,4BACA,yBACE,yBACE,qBAAgBjC,GAAhB,SACE,0BACA,iCACA,wDAEF,0BACA,qBAAiBA,GAAjB,aACE,0BACA,qCACA,0D,WCzBC0H,GAAQ,WAEnB,IAAM/I,EAAYoC,YAAS7J,KAE3B,OAAO+J,mBAAQ,kBAAM0G,aAjEIC,EAiEoBjJ,EAhE7C,CACE,CACEkJ,KAAM,IACNC,OAAO,EACPC,UAAWnB,GAEb,CACEiB,KAAM,UACNC,OAAO,EACPE,UAAU,EACVD,UAAW9F,IAEb,CACE4F,KAAM,0BACNC,OAAO,EACPC,UAAWE,gBAAK,kBAAM,kCAExB,CACEJ,KAAM,YACNC,OAAO,EACPE,UAAU,EACVD,UAAW,kBAAM,kBAAC,IAAD,CAAU/H,GAAG,8BAEhC,CACE6H,KAAM,kBACNC,OAAO,EACPE,UAAU,EACVD,UAAWE,gBAAK,kBAAM,kCAExB,CACEJ,KAAM,0BACNC,OAAO,EACPE,UAAU,EACVD,UAAWE,gBAAK,kBAAM,kCAExB,CACEJ,KAAM,QACNC,OAAO,EACPE,UAAU,EACVD,UAAW,kBAAM,kBAAC,IAAD,CAAU/H,GAAG,0BAEhC,CACE6H,KAAM,sBACNC,OAAO,EACPE,UAAU,EACVD,UAAWE,gBAAK,kBAAM,kCAExB,CACEJ,KAAM,IACNE,UAAWd,IAEbxJ,KAAI,SAACyK,GACL,OAAIA,EAAMF,UAAYE,EAAMF,WAAaJ,GACvCM,EAAMH,UAAY,kBAAM,kBAAC,IAAD,CAAU/H,GAAG,OAC9BkI,GAGFA,OA1De,IAACN,IAiEiC,CAACjJ,K,4FC1DvDhG,GAAO,sDAUPwP,GAAc,4DAiBdC,GAAY,0DAQZC,GAAe,4DAafC,GAAY,IAAIC,IAAsC,CAC1D,CAAC,GAAD,EAAaN,gBAAK,kBAAM,0DAGbO,GAAmB,WAAM,MACArG,mBAApC,IADoC,oBAC9B,EAD8B,KAC9B,EAD8B,KAI9BsG,EAAS1H,YAAf,MAEM2H,EAAa,yCAAG,mCAAAzR,EAAA,yDACd0R,EAAQC,aAAd,GADoB,oDAMZC,EAAR,EAAQA,QAEFC,EAAWC,EAAjB,GARoB,eAShBD,iBATgB,aAShBA,YATgB,sCASsBA,UAA1C,WAToB,wFAapBE,aAAa,CAAEH,YAbK,4CAAH,qDAgBbI,EAAqB,SAACzG,GAEtBA,WAAaA,EAAjB,eAIAkG,KAyBIQ,EAtBkB,WACtB,IAD4B,EACtBA,EAAN,GAD4B,eAK5B,GAL4B,IAK5B,2BAAoD,eAAzC,EAAyC,EAAzC,YAAyC,EAAzC,QAAsBC,EAAmB,EAAnBA,MACzBC,EAAiBd,OAAvB,GACA,GACEY,OAAa,CACXG,YACAR,UACAM,QACAC,oBAZsB,8BAiB5B,SAGkBE,GAEJ,KAAgB,YAAwC,IAAvC,EAAuC,EAAvC,UAAuC,EAAvC,MAAkBF,EAAqB,EAArBA,eAC7CN,EAAWC,EAAf,GAUA,OARA,IACED,EAAWS,sBACXC,GAAeC,YAAD,oBAAC,gBAAW,GAAZ,mBAEZ,EAAWX,QAKb,8BAAUY,SAAV,KAA0BnG,IAA1B,GACE,0BACE,sBAAc/B,QAAd,GACE,wCAEEqH,QAFF,EAGEC,SAHF,EAIEa,MAAO,mBAAiBX,aAAa,CAAEH,UAASrQ,qBAQ5D,OAAI0Q,SAAJ,EAEI,0BACE,2BACA,GAKN,M,OCnJFU,IAAMC,OAAOC,KACbF,IAAMC,OAAOE,KAEN,IAAMC,GAAgB,WAG3B,OAFAlJ,YAAQgF,KAGN,oCACE,kBAAC,IAAD,CAAQnP,QAASA,KACf,kBAAC,WAAD,CAAU+S,SAAU,MAClB,kBAAC,GAAD,QAGJ,kBAAC,GAAD,QCtBN5S,IAAImT,eAAc,SAACC,GAEbA,IAAahT,KACfgT,EAASC,MAAM7E,QAInBxO,IAAIsT,gBAAe,SAACC,GAClBA,EAAUC,SAAStT,OAAM,SAACuT,GAAD,OAAaC,QAAQjS,MAAMgS,S,sFCItDxE,KAAyB1J,IAAzB,yCACE,sDAAApF,EAAA,6DAASoC,EAAT,EAASA,MAAOO,EAAhB,EAAgBA,sBAAuBC,EAAvC,EAAuCA,UAC/BZ,EAAaqD,eACbC,EAASC,eAAY1E,OACrB4B,EAA0B,IAAIqK,KAHtC,SAKmCjG,KAAU2M,mBACzC,CAAC/Q,EAAwBK,UAAU0B,YACnCwB,MAPJ,2CAKS1D,EALT,KAKoBI,EALpB,KAUQ+Q,EAAyC,GAVjD,UAa8B1R,KAAQgB,2CAClCf,GAdJ,eAaQgB,EAbR,OAiBEyQ,EAAarT,KACXgD,KAAcC,cAAc,CAC1BC,WAAYgC,EACZ/B,iBAAkBd,EAAwBK,UAC1CrC,SAAUuC,EACVQ,MAAOC,KAAuBC,KAC9BC,UAAWqC,QAIfyN,EAAarT,KACX2B,KAAQ6B,kCACNnB,EACAH,EACAF,EACAsR,KACAC,KACA3N,KACAV,EACA5C,EACAC,EACAC,IAtCN,UA0C4BgR,aAAgBH,EAAc,CACtDhR,IA3CJ,eA0CQQ,EA1CR,yBA6CS4Q,aAAgB5Q,IA7CzB,4CADF,uDCHAmF,KAAqBhD,IAArB,yCACE,kDAAApF,EAAA,6DACEyC,EADF,EACEA,wBACAH,EAFF,EAEEA,UACAyC,EAHF,EAGEA,aACApC,EAJF,EAIEA,sBACAC,EALF,EAKEA,UAEMZ,EAAaqD,eACbC,EAASC,eAAY1E,OACrBiE,EAAsB,IAAIgI,MAE1B2G,EAAyC,IAElCrT,KACX0T,KAASC,yBACPJ,KACA5O,EACAzC,EACAiD,eAAY1E,OACZ,GACA,MApBN,SAyB8BkB,KAAQiS,uCAClChS,GA1BJ,cAyBQgB,EAzBR,OA6BEyQ,EAAarT,KACXgD,KAAcC,cAAc,CAC1BC,WAAYgC,EACZ/B,iBAAkBuB,EAAoBhC,UACtCrC,SAAUuC,EACVQ,MAAO0B,KAAmBxB,KAC1BC,UAAWqC,QAIfyN,EAAarT,KACX2B,KAAQkS,8BACNnP,EACArC,EACAsC,EACA4O,KACAD,KACA1N,KACArD,EACAC,IAhDN,UAoD4BgR,aAAgBH,EAAc,CACtD3O,IArDJ,eAoDQ7B,EApDR,yBAuDS4Q,aAAgB5Q,IAvDzB,4CADF,uDCRA8E,KAAuB3C,IAAvB,yCAA2B,kCAAApF,EAAA,6DAAS4J,EAAT,EAASA,YAC5B5H,EAAaqD,eADM,SAENrD,EAAWkS,eAAetK,GAFpB,UAEnBuK,EAFmB,gDAIhB,MAJgB,6DAQpBA,GARoB,IASvBzT,KAAMgG,aAA0ByN,EAAKzT,SATd,2CAA3B,uD,cCCAwH,KAAgC9C,IAAhC,yCAAoC,oCAAApF,EAAA,6DAASoC,EAAT,EAASA,MACrCJ,EAAaqD,eACbC,EAASC,eAAY1E,OAFO,SAIbmB,EAAWoS,8BAA8B9O,EAAQ,CACpE3B,UAAWgQ,KACXU,KAAMjS,IAN0B,cAI5Bb,EAJ4B,yBAS3BA,EAAO8K,MAAM7F,KAAI,SAAA1F,GAAO,OAAIA,MATD,2CAApC,uD,+BCSAX,IAAUiF,IAAV,wBAAc,iCAAApF,EAAA,6DACN0O,EAAUJ,IAASpO,WACnBoU,EAAO/F,IAAMrO,WAFP,SAGSqU,KAAkB7F,EAAS4F,GAHpC,cAGNhP,EAHM,QAKLmD,GAAG0E,KAAYqH,YAAY,WAChCpG,cACAmF,QAAQjS,MAAM,0BAGhBgE,EAAOmD,GAAG0E,KAAYsH,WAAW,gBAAGC,EAAH,EAAGA,qBAAH,OAC/BnB,QAAQY,KAAR,qBAA2BO,OAG7BnB,QAAQY,KAAK,oBAdD,kBAgBL7O,EAAOzE,OAAOgF,YAhBT,4CAmBduI,IAAahJ,KAAI,WACfmP,OACAhB,QAAQjS,MAAM,0BAGhBgN,IAAS7F,GAAG4F,KAAe,SAAC1F,EAAG+F,GAAJ,OAAgBA,KAE3CzO,IAAWwI,GAAGtI,IAAUwU,MAAM,kBAAM,KAAMlM,GAAG2F,KAAc,kBAAM,KAEjEvF,mBAAQ,CAAD,SAAC,CACNlC,KAAM0H,IACNtF,GAAI,CAAC5I,MAFA,kB,6BAAA,mCAKPyU,aAAQ,CACNC,MAAOvG,IACPhC,IAAK,Y,IC/CDwI,GAAW,IAAIxD,IACjBM,GAAU,EAEdG,KAAa3M,KAAI,YAA+B,IAA5BwM,EAA4B,EAA5BA,QAASrQ,EAAmB,EAAnBA,OAC3B,IAAKqQ,EACH,MAAM,IAAIvL,MAAM,wCAGlB,IAAM0O,EAAaD,GAASE,IAAIpD,GAE5BmD,IACFA,EAAWlH,QAAQtM,GACnBuT,GAASG,OAAOrD,IAGlBsD,aAAW,CAAEtD,eAGfuD,KAAY/P,KACV,YAA4C,IAAzCgN,EAAyC,EAAzCA,UAAWF,EAA8B,EAA9BA,MAGZ,GAFekD,KAAQlV,WAEZmV,MAAK,SAAC3D,GAAD,OAAWA,EAAMU,YAAcA,KAE7C,MAAM,IAAI/L,MAAJ,6BAAgC+L,IAGxCR,KAAYA,GAEZ0D,aAAU,CAAElD,YAAWR,WAASM,UAEhC,IAAMqD,EAAU,IAAI3H,SAAQ,SAACC,GAC3BiH,GAASU,IAAI5D,GAAS,CACpBA,WACA/D,eAQJ,OAFA0H,EAAQ3D,QAAUA,GAEX2D,KAIXH,KACG3M,GAAGyM,MAAY,SAAC1C,EAAOc,GAAR,OACdd,EAAM1L,QAAO,SAAC2O,GAAD,OAAYA,EAAO7D,UAAY0B,EAAQ1B,cAErDnJ,GAAG6M,MAAW,SAAC9C,EAAOc,GAAR,OAAoBd,EAAMkD,OAAOpC,MCzClDqC,4BAEO,ICXyBC,GDWnBC,GAAN,UA0BPC,WACE,kBAAC,IAAD,gBACE,4BAEFC,uBAJFD,UCpCMF,IAAeA,cAAuBI,UACxC,8BAAqBC,MAAK,YAAiD,IAA9CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAON,IACPO,EAAOP,IACPQ,EAAOR,IACPS,EAAOT,IACPU,EAAQV,O,wPCuBVtQ,EACAtD,EAKQwM,E,yHCjCN+H,EAAmB,wBAOZC,EAAb,kDAGE,WAAY7J,GAAsD,MAArC8J,EAAqC,uDAAlBF,EAAkB,4BAChE,cAAM5J,IAHA+J,kBAE0D,EAEhE,EAAKA,aAAe,IAAIC,IAAoBF,EAAU9J,GAGtD,EAAK+J,aAAajO,GAAG0E,IAAYC,SAAS,kBAAM,EAAKF,KAAKC,IAAYC,YACtE,EAAKsJ,aAAajO,GAAG0E,IAAYqH,YAAY,kBAAM,EAAKtH,KAAKC,IAAYqH,eAEpE,EAAKkC,aAAaE,UARyC,EAHpE,wCAcE,WACE,OAAOpU,KAAKkU,aAAa5T,YAf7B,wBAkBE,WACEN,KAAKkU,aAAaG,eAnBtB,6BAsBE,SAAgB5T,GACd,OAAOT,KAAKkU,aAAaI,gBAAgB7T,OAvB7C,GAAkC6K,KDY5BiJ,EAA4BC,KAA0B,IAWtDC,EAAsB,iB,SAGhBzI,O,mBAAAA,I,mBAAAA,I,qBAAAA,I,kBAAAA,M,KAOZ,IAAM0I,EAAe,SAAC5C,EAAkB5F,GACtC,IAAM/B,EAAUwK,YAAWzI,GAC3B,OAAQ4F,GACN,KAAK9F,EAAW4I,MACd,OAAO,IAAI1K,IAAYC,GACzB,KAAK6B,EAAWC,OACd,OAAO,IAAI+H,EAAa7J,GAC1B,KAAK6B,EAAW6I,QACd,OAAO,IAAIb,EAAa7J,EAAS,8BACnC,QACE,OAAO,IAAI6J,EAAa7J,KAIjBiK,EAAO,uCAAG,WACrBlI,EACA4F,GAFqB,eAAAtU,EAAA,6DAIfsX,EAAYJ,EAAa5C,EAAM5F,GAIrCpJ,EAASgS,EACTtV,EAAaqD,YAAcqJ,GATN,kBAYd,IAAId,SAAQ,SAACC,GAClByJ,EAAU7O,GAAG0E,IAAYC,SAAS,kBAAMS,EAAQyJ,UAb7B,2CAAH,wDAiBPT,EAAa,kCAAYvR,SAAZ,aAAY,EAAQuR,cAEjCjD,EAAe,uCAAG,WAC7BH,GAD6B,mCAAAzT,EAAA,yDAE7B+N,EAF6B,+BAER,GAEhBzI,GAAWtD,EAJa,sBAKrB,IAAIqE,MAAM4Q,GALW,uBAQgBjV,EAAWuV,qBAR3B,uBAQVC,EARU,EAQrBC,UAEFC,EAVuB,CAUT,CAAE5U,UAAWwC,EAAOzE,SAVX,mBAUwBkN,KAC/C9K,EAAc,IAAIC,IAAY,CAClCsU,kBACAE,gBAEUvU,IAAZ,MAAAF,EAAW,YAAQwQ,IAIf1F,EAAQ4J,OAAS,GACnB1U,EAAY2U,YAAZ,MAAA3U,EAAW,YAAgB8K,IApBA,kBAuBtB9K,GAvBsB,4CAAH,sDA+BtB4U,EAAqB,CACzB5R,WAAY6R,IACZ5J,oBAAqB4J,K,SAGRC,E,gFAAf,WACEzK,EACArH,GAFF,SAAAjG,EAAA,6DAIEuT,QAAQyE,IAAR,gCAAqC1K,EAArC,4BAJF,SAKQ2K,YAAmB3K,EAAWrH,GALtC,cAMEsN,QAAQyE,IAAR,sBAA2B1K,EAA3B,eAEIhI,GACFA,EAAO4H,KAAKC,IAAYsH,UAAW,CAAEC,qBAAsBpH,IAT/D,SAcQ4K,YAAMnB,GAdd,gCAeSzJ,GAfT,4C,sBAkBO,IAAMuG,EAAe,uCAAG,WAC7B5Q,GAD6B,uCAAAjD,EAAA,0FAKH6X,EALG,IAG3B5R,kBAH2B,MAGd4R,EAAmB5R,WAHL,MAI3BiI,2BAJ2B,MAIL2J,EAAmB3J,oBAJd,EAOxB5I,GAAWtD,EAPa,sBAQrB,IAAIqE,MAAM4Q,GARW,cAW7B1D,QAAQyE,IAAI,uCAXiB,SAYR1S,EAAOkI,KAAKvK,GAZJ,cAYvBkV,EAZuB,OAa7B5E,QAAQyE,IAAI,yCAbiB,UAcLhW,EAAWoW,mBAAmBD,EAAOE,YAAa,CACxEnK,wBAf2B,eAcvBZ,EAduB,yBAkBtByK,EAAkBzK,EAAWrH,IAlBP,4CAAH,sDAqBfV,EAAY,WACvB,IAAKD,IAAWtD,EACd,MAAM,IAAIqE,MAAM,+BAGlB,OAAOf,I,+GEzJIxC,EAAY,WAAiD,IAAhDwV,EAAgD,uDAArC,YACnC,OAAOtU,OAAkB,GAAIsU,IAMlBC,EAAS,WAA8C,IAA7CD,EAA6C,uDAAlC,SAChC,OAAOtU,OAAkB,EAAGsU,K,8MCM1BE,E,kFCTEC,EAAoC,CAExCC,MAAO,EACPC,WAAY,IAEZC,kBAAmB,KDFRC,EAAe,wBAIff,EAAiCgB,IAKxCC,EAAmBC,YACvBC,KACA,SAACtM,GACC,IAAM3K,EAAa,IAAIkX,IAAWvM,EAASmL,GAqB3C,MAjByB,CACvB,aACA,iBACA,uBACA,2BACA,gCACA,qBACA,kBACA,qBACA,kBAEeqB,SAAQ,SAACC,GAGxBpX,EAAWoX,GCba,SAC5BC,GAE+B,IAD/BC,EAC+B,uDADOb,EAGhCc,EAAUC,YAAUF,EAAcb,GAElCgB,EAAe,SACnBrQ,EACAsQ,EACAC,GAHmB,8CAIhB,WACHC,EACAC,EACAC,GAHG,eAAA9Z,EAAA,yDAMG+Z,EANH,+BAAA/Z,EAAA,MAMU,sBAAAA,EAAA,+EAAYoJ,EAAO4Q,MAAMN,EAASC,IAAlC,2CANV,qDASEC,EATF,yCAUMG,KAVN,gCAcIH,EAAcK,OAAM,SAAC3Y,GAC1B,IAAM4Y,EACJX,EAAQZ,WAAR,SAAqBY,EAAQX,kBAAqBkB,GAMpD,OALAvG,QAAQjS,MAAMA,GACdiS,QAAQyE,IAAR,yBACoBkC,EADpB,wBAC2CJ,EAD3C,YAIO5B,YAAMgC,GAASjE,KAAK8D,OAtB1B,2CAJgB,2DA8BrB,OAAO,IAAII,MAAMd,EAAI,CAGnBW,MAAO,SAAC5Q,EAAQsQ,EAASC,GAIvB,OAAO,YAAI,IAAIS,MAAMb,EAAQb,QAC1B2B,OAAOZ,EAAarQ,EAAQsQ,EAASC,IACrCM,OAAM,SAAC3Y,GAEN,MADAiS,QAAQjS,MAAM,8BACRA,QDnCWgZ,CAAetY,EAAWoX,OAG1CpX,KAIEmV,EAAa,SAACzI,GACzB,MAAgB,aAAZA,EACKmK,EAGO,iBAAZnK,EACK,uCAGF6L,YAAc7L,IAGVrJ,EAAgB,SAACqJ,GACxBA,IACF8J,EAAiB9J,GAGnB,IAEM/B,EAAUwK,EAFQzI,GAAW8J,GAGnC,OAAOO,EAAiBpM,IAGbsL,EAAqB,SAChC3K,EACArH,GAEA,IAAMjE,EAAaqD,IACbmV,EAAmB,IAAI5M,SAAyB,SAACC,GAAD,OACpD7L,EAAWyY,YAAYnN,GAAW,SAACoN,GACjCnH,QAAQyE,IAAI,2BAA4B0C,GACxC7M,EAAQ6M,SAINC,EAAiB3Y,EACpBiW,mBAAmB3K,EAAWrH,GAAc6R,GAC5C7B,MAAK,SAACyE,GAEL,OADAnH,QAAQyE,IAAI,yBAA0B0C,GAC/BA,EAAgBrO,SAG3B,OAAOuB,QAAQgN,KAAK,CAACD,EAAgBH,M,wGExF3BrN,E,kFAAAA,K,kBAAAA,E,wBAAAA,E,gBAAAA,E,uBAAAA,M,KAYL,IAAeW,EAAtB,kDAGE,WAAsBnB,GAAiB,kCACrC,gBAHMA,aAE+B,EAErC,EAAKA,QAAUA,EAFsB,EAHzC,+EAgBE,WAAW1J,GAAX,eAAAjD,EAAA,sEACkCwC,KAAKsU,gBAAgB7T,GADvD,cACQ4X,EADR,OAEErY,KAAK0K,KAAKC,EAAY2N,OAAQ,CAAE7X,YAAa4X,IAF/C,kBAISA,GAJT,gDAhBF,4DAAqCE,M,gCChBrC,gFAEa/U,EAAqB,IAAIa,IACpC,gDAGW6M,EAAsB,IAAI7M,IACrC,iD,gJCDWpD,EAAyBO,IAAa1D,OAAO,CACxD0D,IAAagX,GAAG,iBAChBhX,IAAagX,GAAG,SAChBlY,YAAU,SACVA,YAAU,aACVA,YAAU,SACVyV,YAAO,yBACPA,YAAO,eAGF,SAAS7R,EACdhG,GAEA,IAAMua,EAAcxX,EAAuByX,OAAOxa,GAUlD,OATAua,EAAYrU,cAA8C,IAA9BqU,EAAYrU,cACxCqU,EAAYza,MAAQ,IAAIqG,IAAUoU,EAAYza,OAC9Cya,EAAY3Y,UAAY,IAAIuE,IAAUoU,EAAY3Y,WAClD2Y,EAAY7Y,MAAQ,IAAIyE,IAAUoU,EAAY7Y,OAC9C6Y,EAAYtY,sBAAwBwY,IAAIC,WACtCH,EAAYtY,uBAEdsY,EAAYrY,UAAYuY,IAAIC,WAAWH,EAAYrY,WAE5CqY,I,sPC1BI7F,EAAUvV,IAAIyH,YAAyB,GAA7B,8DAEVyK,EAAelS,IAAIsO,aAAJ,mEAQf+G,EAAarV,IAAIC,YAAJ,iEAEbqV,EAActV,IAAIsO,aAAJ,mEAQdmH,EAAYzV,IAAIC,YAAJ,iE,4KCpBZ8M,GAC+ByO,EAG/BxO,EACXD,GAASyO,mIAAYC,6BAEVxC,EACVuC,mIAAYvD,oBAAqC,eAIvCd,EAAyBuE,OACpCF,mIAAYtE,4B,gJCVD7R,EAAqBlB,IAAa1D,OAAO,CACpD0D,IAAagX,GAAG,iBAChBhX,IAAagX,GAAG,cAChBlY,YAAU,2BACVA,YAAU,gBACVA,YAAU,SACVyV,YAAO,cACPA,YAAO,yBACPA,YAAO,aACPA,YAAO,qBAGF,SAASrR,EAAsBxG,GACpC,IAAMua,EAAc/V,EAAmBgW,OAAOxa,GAe9C,OAdAua,EAAYrU,cAA8C,IAA9BqU,EAAYrU,cACxCqU,EAAYO,WAAwC,IAA3BP,EAAYO,WACrCP,EAAYxY,wBAA0B,IAAIoE,IACxCoU,EAAYxY,yBAEdwY,EAAYlW,aAAe,IAAI8B,IAAUoU,EAAYlW,cACrDkW,EAAYza,MAAQ,IAAIqG,IAAUoU,EAAYza,OAC9Cya,EAAYQ,WAAaN,IAAIC,WAAWH,EAAYQ,YACpDR,EAAYtY,sBAAwBwY,IAAIC,WACtCH,EAAYtY,uBAEdsY,EAAYrY,UAAYuY,IAAIC,WAAWH,EAAYrY,WACnDqY,EAAYS,gBAAkBP,IAAIC,WAAWH,EAAYS,iBAElDT,I,gHC7BH7L,EAAY,6DA+CLuM,EAA8D,SAAC,GAOtE,IAPsE,EAOtE,EAPsE,UAOtE,EAPsE,SAOtE,EAPsE,WAOtE,EAPsE,UAOtE,EAPsE,SAM1E/Z,EACI,EADJA,UAEA,OACE,qBACE4I,SADF,EAEE5I,UAAWwI,IAAWxI,EAAW,CAAEiO,UAASE,WAC5CxF,QAHF,GAKE,I,gHClEO2N,EAAuC,SAAC0D,GAAD,OAClD,IAAIhO,SAAQ,SAACC,GAAD,OAAagO,WAAWhO,EAAS+N,OAExC,SAASvR,EAAayR,GAC3B,gBAAUA,EAAQC,MAAM,EAAG,GAA3B,iBAAiCD,EAAQC,OAAO,M,yJCS5Cra,EAAO,sDAUPqN,EAAS,uDAMTiN,EAAI,mDAQJC,EAAK,oDAYEC,EAAoB,SAAC,GAAoB,IAAlBtM,EAAkB,EAAlBA,YAC5BlB,EAAU5E,YAAhB,KACMpC,EAAYoC,YAAlB,KAMA,OACE,yBACE,2BACE,yBACE,uBAAMf,GAAN,KACE,2BAEF,yBACE,uBACEoT,YADF,iBAEErQ,SAFF,EAGEF,MAAO,CACL,CAAES,MAAO,gBACT,CAAEA,MAAO,WACT,CAAEA,MAAO,UACT,CAAEA,MAAO,aAEXpB,SArBgB,SAACyD,GAC3BL,kBAsBSuB,EACC,uBAAQC,SAAR,EAAgBtF,QAAhB,KACI7C,EAAF,UAAc,WAFlB,U,uGCxENhG,EAAO,qDAQA0a,EAA2B,SAAC,GAAiB,IAAfC,EAAe,EAAfA,SACzC,OAAO,yBAAP,I","file":"static/js/main.01514883.chunk.js","sourcesContent":["import { createBrowserHistory } from 'history';\n\nexport const history = createBrowserHistory();\n","import { app } from 'models/app';\nimport { ButtonClick } from 'types/effector';\nimport { $connected, connectFx } from 'models/wallet';\nimport { history } from 'lib/routing';\n\nexport const connectAndCreateClicked = app.createEvent<ButtonClick>();\n\nconnectAndCreateClicked.watch(async () => {\n  const connected = $connected.getState();\n  if (!connected) {\n    await connectFx();\n  }\n  history.push('/select');\n});\n","import { struct } from 'superstruct';\n\nfunction jsonRpcResult(resultDescription: any) {\n  const jsonRpcVersion = struct.literal('2.0');\n  return struct.union([\n    struct({\n      jsonrpc: jsonRpcVersion,\n      id: 'string',\n      error: 'any',\n    }),\n    struct({\n      jsonrpc: jsonRpcVersion,\n      id: 'string',\n      error: 'null?',\n      result: resultDescription,\n    }),\n  ]);\n}\n\nconst AccountInfoResult = struct({\n  executable: 'boolean',\n  owner: 'string',\n  lamports: 'number',\n  data: 'any',\n  rentEpoch: 'number?',\n});\n\nconst ProgramAccountInfoResult = struct({\n  pubkey: 'string',\n  account: AccountInfoResult,\n});\n\n/**\n * Expected JSON RPC response for the \"getProgramAccounts\" message\n */\nexport const GetProgramAccountsRpcResult = jsonRpcResult(\n  struct.array([ProgramAccountInfoResult]),\n);\n","import React, { FC, HTMLAttributes } from 'react';\n\nimport { styled } from '@linaria/react';\n\nconst Wrapper = styled.div`\n  padding: 20px;\n\n  background: #fff;\n  border: 1px solid #eaeaea;\n  border-radius: 8px;\n`;\n\nexport const Card: FC<HTMLAttributes<HTMLDivElement>> = ({\n  children,\n  style,\n  className,\n}) => {\n  return (\n    <Wrapper style={style} className={className}>\n      {children}\n    </Wrapper>\n  );\n};\n","export const MODAL_PLAN = 'MODAL_PLAN';\n","import {\n  Connection,\n  PublicKey,\n  SystemProgram,\n  Transaction,\n  Account,\n  TransactionInstruction,\n  SYSVAR_CLOCK_PUBKEY,\n} from '@solana/web3.js';\n\nimport * as BufferLayout from 'buffer-layout';\nimport { Numberu64 } from '@solana/spl-token-swap';\nimport * as Layout from './layout';\nimport { SubscriptionLayout } from './layouts/subscription';\nimport { SubscriptionPlanLayout } from './layouts/subscriptionPlan';\nimport { sendAndConfirmTransaction } from './utils/send-and-confirm-transaction';\n\nexport class SollPay {\n  private connection: Connection;\n\n  /**\n   * Program Identifier for the SollPay program\n   */\n  private sollPayProgramId: PublicKey;\n\n  /**\n   * Program Identifier for the Token program\n   */\n  private tokenProgramId: PublicKey;\n\n  /**\n   * The public key identifying subscription plan program\n   */\n  private subscriptionPlan: PublicKey;\n\n  /**\n   * The public key for the subscription plan token mint\n   */\n  private token: PublicKey;\n\n  /**\n   * The public key for the fee account receiving fee\n   */\n  private feeAccount: PublicKey;\n\n  /**\n   * Authority\n   */\n  private authority: PublicKey;\n\n  /**\n   * Fee payer\n   */\n  private payer: Account;\n\n  /**\n   * Owner\n   */\n  private owner: PublicKey;\n\n  constructor(\n    connection: Connection,\n    subscriptionPlan: PublicKey,\n    sollPayProgramId: PublicKey,\n    tokenProgramId: PublicKey,\n    token: PublicKey,\n    feeAccount: PublicKey,\n    authority: PublicKey,\n    payer: Account,\n    owner: PublicKey,\n  ) {\n    this.connection = connection;\n    this.subscriptionPlan = subscriptionPlan;\n    this.sollPayProgramId = sollPayProgramId;\n    this.tokenProgramId = tokenProgramId;\n    this.token = token;\n    this.feeAccount = feeAccount;\n    this.authority = authority;\n    this.payer = payer;\n    this.owner = owner;\n  }\n\n  static async createSubscriptionPlan(\n    connection: Connection,\n    payer: Account,\n    subscriptionPlanAccount: Account, // TODO: maybe inside\n    authority: PublicKey, // TODO: maybe inside\n    token: PublicKey,\n    feeAccount: PublicKey,\n    sollPayProgramId: PublicKey,\n    tokenProgramId: PublicKey,\n    nonce: number,\n    owner: PublicKey,\n    subscriptionTimeframe: number | Numberu64,\n    maxAmount: number | Numberu64,\n  ) {\n    const sollPay = new SollPay(\n      connection,\n      subscriptionPlanAccount.publicKey,\n      sollPayProgramId,\n      tokenProgramId,\n      token,\n      feeAccount,\n      authority,\n      payer,\n      owner,\n    );\n\n    // Allocate memory for the account\n    const balanceNeeded = await SollPay.getMinBalanceRentForExemptSubscriptionPlan(\n      connection,\n    );\n\n    const transaction = new Transaction();\n    transaction.add(\n      SystemProgram.createAccount({\n        fromPubkey: payer.publicKey,\n        newAccountPubkey: subscriptionPlanAccount.publicKey,\n        lamports: balanceNeeded,\n        space: SubscriptionPlanLayout.span,\n        programId: sollPayProgramId,\n      }),\n    );\n\n    transaction.add(\n      SollPay.createSubscriptionPlanInstruction(\n        subscriptionPlanAccount,\n        authority,\n        token,\n        feeAccount,\n        tokenProgramId,\n        sollPayProgramId,\n        owner,\n        nonce,\n        subscriptionTimeframe,\n        maxAmount,\n      ),\n    );\n\n    await sendAndConfirmTransaction(\n      'createAccount and CreateSubscriptionPlan',\n      connection,\n      transaction,\n      payer,\n      subscriptionPlanAccount,\n    );\n\n    return sollPay;\n  }\n\n  static createSubscriptionPlanInstruction(\n    subscriptionPlanAccount: Account,\n    authority: PublicKey,\n    token: PublicKey,\n    feeAccount: PublicKey,\n    tokenProgramId: PublicKey,\n    recurringPaymentsProgramId: PublicKey,\n    owner: PublicKey,\n    nonce: number,\n    subscriptionTimeframe: number | Numberu64,\n    maxAmount: number | Numberu64,\n  ): TransactionInstruction {\n    const dataLayout = BufferLayout.struct([\n      BufferLayout.u8('instruction'),\n      BufferLayout.u8('nonce'),\n      Layout.uint64('subscription_timeframe'),\n      Layout.uint64('max_amount'),\n    ]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 0, // CreateSubscriptionPlan instruction\n        nonce,\n        subscription_timeframe: new Numberu64(subscriptionTimeframe).toBuffer(),\n        max_amount: new Numberu64(maxAmount).toBuffer(),\n      },\n      data,\n    );\n\n    const keys = [\n      {\n        pubkey: subscriptionPlanAccount.publicKey,\n        isSigner: false,\n        isWritable: true,\n      },\n      { pubkey: owner, isSigner: false, isWritable: false },\n      { pubkey: authority, isSigner: false, isWritable: false },\n      { pubkey: token, isSigner: false, isWritable: false },\n      // { pubkey: feeAccount, isSigner: false, isWritable: false },\n      // { pubkey: tokenProgramId, isSigner: false, isWritable: false },\n    ];\n\n    return new TransactionInstruction({\n      keys,\n      programId: recurringPaymentsProgramId,\n      data,\n    });\n  }\n\n  static createSubscriptionInstruction(\n    subscriptionAccount: Account,\n    subscriptionPlanAccount: PublicKey,\n    tokenAccount: PublicKey,\n    tokenProgramId: PublicKey,\n    feeAccount: PublicKey,\n    recurringPaymentsProgramId: PublicKey,\n    subscriptionTimeframe: number | Numberu64,\n    maxAmount: number | Numberu64,\n  ): TransactionInstruction {\n    const dataLayout = BufferLayout.struct([\n      BufferLayout.u8('instruction'),\n      Layout.uint64('subscription_timeframe'),\n      Layout.uint64('max_amount'),\n    ]);\n\n    const data = Buffer.alloc(dataLayout.span);\n    dataLayout.encode(\n      {\n        instruction: 1, // CreateSubscription instruction\n        subscription_timeframe: new Numberu64(subscriptionTimeframe).toBuffer(),\n        max_amount: new Numberu64(maxAmount).toBuffer(),\n      },\n      data,\n    );\n\n    const keys = [\n      {\n        pubkey: subscriptionAccount.publicKey,\n        isSigner: false,\n        isWritable: true,\n      },\n      { pubkey: subscriptionPlanAccount, isSigner: false, isWritable: false },\n      { pubkey: tokenAccount, isSigner: false, isWritable: false },\n      { pubkey: tokenProgramId, isSigner: false, isWritable: false },\n      { pubkey: SYSVAR_CLOCK_PUBKEY, isSigner: false, isWritable: false },\n      { pubkey: feeAccount, isSigner: false, isWritable: false },\n    ];\n\n    return new TransactionInstruction({\n      keys,\n      programId: recurringPaymentsProgramId,\n      data,\n    });\n  }\n\n  /**\n   * Get the minimum balance for the subscription plan account to be rent exempt\n   *\n   * @return Number of lamports required\n   */\n  static async getMinBalanceRentForExemptSubscriptionPlan(\n    connection: Connection,\n  ): Promise<number> {\n    return connection.getMinimumBalanceForRentExemption(\n      SubscriptionPlanLayout.span,\n    );\n  }\n\n  /**\n   * Get the minimum balance for the subscription account to be rent exempt\n   *\n   * @return Number of lamports required\n   */\n  static async getMinBalanceRentForExemptSubscription(\n    connection: Connection,\n  ): Promise<number> {\n    return connection.getMinimumBalanceForRentExemption(\n      SubscriptionLayout.span,\n    );\n  }\n}\n","import assert from 'assert';\nimport { PublicKey } from '@solana/web3.js';\nimport { complement, isNil } from 'ramda';\nimport { getConnection } from 'api/connection';\nimport { getWallet } from 'api/wallet';\nimport {\n  parseSubscriptionPlanData,\n  SubscriptionPlanLayout,\n} from 'lib/sollpay/layouts/subscriptionPlan';\nimport { GetProgramAccountsRpcResult } from '../structs';\nimport { findSubscriptionPlansFx } from '..';\nimport { SOLLPAY_PROGRAM_ID } from '../../../constants/common';\n\nfindSubscriptionPlansFx.use(async () => {\n  const connection = getConnection();\n  const wallet = getWallet().pubkey;\n\n  const filters = [\n    {\n      memcmp: {\n        offset: SubscriptionPlanLayout.offsetOf('owner'),\n        bytes: wallet.toBase58(),\n      },\n    },\n    {\n      dataSize: SubscriptionPlanLayout.span,\n    },\n  ];\n\n  const unsafeRes = await connection._rpcRequest('getProgramAccounts', [\n    SOLLPAY_PROGRAM_ID.toBase58(),\n    {\n      commitment: connection.commitment,\n      filters,\n      encoding: 'base64',\n    },\n  ]);\n\n  const res = GetProgramAccountsRpcResult(unsafeRes);\n  if (res.error) {\n    throw new Error(\n      'failed to get accounts owned by program ' +\n        SOLLPAY_PROGRAM_ID.toBase58() +\n        ': ' +\n        res.error.message,\n    );\n  }\n\n  const { result } = res;\n  assert(typeof result !== 'undefined');\n\n  return result\n    .map((result: any) => {\n      assert(result.account.data[1] === 'base64');\n\n      const parsedData = parseSubscriptionPlanData(\n        Buffer.from(result.account.data[0], 'base64'),\n      );\n      if (!parsedData.isInitialized) {\n        return null;\n      }\n\n      return {\n        pubkey: new PublicKey(result.pubkey),\n        account: {\n          executable: result.account.executable,\n          owner: new PublicKey(result.account.owner),\n          lamports: result.account.lamports,\n          data: parsedData,\n        },\n      };\n    })\n    .filter(complement(isNil));\n});\n","import assert from 'assert';\nimport { PublicKey } from '@solana/web3.js';\nimport { complement, isNil } from 'ramda';\nimport { getConnection } from 'api/connection';\nimport { getWallet } from 'api/wallet';\nimport { SOLLPAY_PROGRAM_ID } from 'constants/common';\nimport {\n  parseSubscriptionData,\n  SubscriptionLayout,\n} from 'lib/sollpay/layouts/subscription';\nimport { GetProgramAccountsRpcResult } from '../structs';\nimport { findSubscriptionsFx } from '..';\n\nfindSubscriptionsFx.use(async () => {\n  const connection = getConnection();\n  const wallet = getWallet().pubkey;\n\n  const filters = [\n    // {\n    //   memcmp: {\n    //     offset: SubscriptionLayout.offsetOf('owner'),\n    //     bytes: wallet.toBase58(),\n    //   },\n    // },\n    {\n      dataSize: SubscriptionLayout.span,\n    },\n  ];\n\n  const unsafeRes = await connection._rpcRequest('getProgramAccounts', [\n    SOLLPAY_PROGRAM_ID.toBase58(),\n    {\n      commitment: connection.commitment,\n      filters,\n      encoding: 'base64',\n    },\n  ]);\n\n  const res = GetProgramAccountsRpcResult(unsafeRes);\n  if (res.error) {\n    throw new Error(\n      'failed to get accounts owned by program ' +\n        SOLLPAY_PROGRAM_ID.toBase58() +\n        ': ' +\n        res.error.message,\n    );\n  }\n\n  const { result } = res;\n  assert(typeof result !== 'undefined');\n\n  return result\n    .map((result: any) => {\n      assert(result.account.data[1] === 'base64');\n\n      const parsedData = parseSubscriptionData(\n        Buffer.from(result.account.data[0], 'base64'),\n      );\n      if (!parsedData.isInitialized) {\n        return null;\n      }\n\n      return {\n        pubkey: new PublicKey(result.pubkey),\n        account: {\n          executable: result.account.executable,\n          owner: new PublicKey(result.account.owner),\n          lamports: result.account.lamports,\n          data: parsedData,\n        },\n      };\n    })\n    .filter(complement(isNil));\n});\n","import { combine, forward, guard } from 'effector';\nimport { createGate } from 'effector-react';\nimport {\n  AccountInfo,\n  ParsedAccountData,\n  PublicKey,\n  RpcResponseAndContext,\n} from '@solana/web3.js';\n\nimport { app } from 'models/app';\nimport {\n  createSubscriptionFx,\n  findSubscriptionPlanFx,\n  getParsedTokenAccountsByOwnerFx,\n} from 'models/connection';\nimport { ISubscriptionPlanRecord } from 'models/connection/types';\nimport { $connected, $availableTokens } from 'models/wallet';\n\nexport const SubscribeGate = createGate<{ planAddress: PublicKey }>();\n\nexport const $subscriptionPlan = app.createStore<AccountInfo<ISubscriptionPlanRecord> | null>(\n  null,\n);\n\nexport const $tokenAccounts = app.createStore<\n  { pubkey: PublicKey; account: AccountInfo<ParsedAccountData> }[]\n>([]);\n\nexport const $store = combine({\n  connected: $connected,\n  subscriptionPlan: $subscriptionPlan,\n  availableTokens: $availableTokens,\n  tokenAccounts: $tokenAccounts,\n  isLoadingPlan: findSubscriptionPlanFx.pending,\n  isLoadingTokenAccounts: getParsedTokenAccountsByOwnerFx.pending,\n  isSubscribing: createSubscriptionFx.pending,\n  isFetching: combine(\n    findSubscriptionPlanFx.pending,\n    createSubscriptionFx.pending,\n    getParsedTokenAccountsByOwnerFx.pending,\n    (one, two, three) => one || two || three,\n  ),\n});\n\n$subscriptionPlan.on(\n  findSubscriptionPlanFx.doneData,\n  (_, subscriptionPlan) => subscriptionPlan,\n);\n\n$tokenAccounts.on(\n  getParsedTokenAccountsByOwnerFx.doneData,\n  (_, tokens) => tokens,\n);\n\nforward({\n  from: SubscribeGate.open,\n  to: findSubscriptionPlanFx,\n});\n\nguard({\n  source: $subscriptionPlan.map((subscriptionPlan) => ({\n    token: subscriptionPlan?.data.token,\n  })),\n  clock: $connected,\n  filter: ({ token }, connected) => Boolean(token) && connected,\n  target: getParsedTokenAccountsByOwnerFx,\n});\n","import React, { FC, useMemo } from 'react';\n\nimport { styled } from '@linaria/react';\nimport { useGate, useStore } from 'effector-react';\nimport { PublicKey } from '@solana/web3.js';\n\nimport classNames from 'classnames';\nimport { Button } from 'components/ui/Button';\nimport { createSubscriptionFx } from 'models/connection';\nimport { connectFx } from 'models/wallet';\nimport { shortAddress } from 'utils/common';\nimport { Card } from '../Card';\nimport { $store, SubscribeGate } from './model';\nimport rocketImg from './rocket.png';\nimport bgImg from './bg.png';\n\nconst WrapperCard = styled(Card)`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  width: 230px;\n\n  background-image: url('${bgImg}');\n  background-repeat: no-repeat;\n  background-position: bottom center;\n  background-size: contain;\n`;\n\nconst Title = styled.div`\n  //margin-bottom: 20px;\n\n  color: #000;\n  font-size: 24px;\n  letter-spacing: -0.47px;\n  font-weight: 600;\n  line-height: 1.5;\n`;\n\nconst Rocket = styled.div`\n  @keyframes fly {\n    0% {\n      transform: rotate(5deg);\n    }\n    50% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(5deg);\n    }\n  }\n\n  width: 50px;\n  height: 60px;\n  margin: 10px;\n\n  background: url('${rocketImg}') no-repeat 50% 50%;\n  background-size: 50px 60px;\n\n  &.isFetching {\n    animation: fly 0.5s linear infinite;\n  }\n`;\n\nconst Group = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  height: 40px;\n  padding: 0 12px;\n\n  color: #666;\n  font-size: 14px;\n  font-weight: 400;\n\n  background: #fafafa;\n  border-radius: 5px;\n  border: 1px solid #eaeaea;\n\n  &.isDisabled {\n    visibility: hidden;\n  }\n`;\n\nconst Price = styled.div`\n  margin-right: 10px;\n\n  font-weight: 600;\n`;\n\nconst SubscribeButton = styled(Button)`\n  margin-top: 20px;\n\n  width: 100%;\n`;\n\nconst renderSubscriptionTimeframe = (subscriptionTimeframe: number) => {\n  switch (subscriptionTimeframe) {\n    case 1:\n      return 'daily';\n    case 7:\n      return 'weekly';\n    case 30:\n      return 'monthly';\n    case 365:\n      return 'yearly';\n    default:\n      return subscriptionTimeframe;\n  }\n};\n\ninterface Props {\n  planAddress: string;\n}\n\n// TODO: make less compexity\n// eslint-disable-next-line sonarjs/cognitive-complexity\nexport const Subscribe: FC<Props> = ({ planAddress }) => {\n  useGate(SubscribeGate, { planAddress: new PublicKey(planAddress) });\n  const {\n    connected,\n    subscriptionPlan,\n    availableTokens,\n    tokenAccounts,\n    isLoadingPlan,\n    isLoadingTokenAccounts,\n    isSubscribing,\n    isFetching,\n  } = useStore($store);\n\n  const tokenMeta = useMemo(\n    () =>\n      availableTokens.find(\n        (token) =>\n          token.mintAddress === subscriptionPlan?.data.token.toBase58(),\n      ),\n    [availableTokens, subscriptionPlan],\n  );\n\n  const tokenAccount = useMemo(() => {\n    if (tokenAccounts.length === 0) {\n      return null;\n    }\n\n    return tokenAccounts.sort(\n      (a, b) =>\n        a.account.data.parsed.info.tokenAmount.uiAmount -\n        b.account.data.parsed.info.tokenAmount.uiAmount,\n    )[0];\n  }, [tokenAccounts]);\n\n  const handleSubscribeClick = async () => {\n    if (!subscriptionPlan) {\n      return;\n    }\n\n    if (!connected) {\n      await connectFx();\n    }\n\n    if (!tokenAccount) {\n      return;\n    }\n\n    await createSubscriptionFx({\n      subscriptionPlanAccount: new PublicKey(planAddress),\n      tokenAccount: tokenAccount.pubkey,\n      authority: subscriptionPlan.data.authority,\n      subscriptionTimeframe: subscriptionPlan.data.subscriptionTimeframe.toNumber(),\n      maxAmount: subscriptionPlan.data.maxAmount.toNumber(),\n    });\n  };\n\n  const renderButtonText = () => {\n    if (isLoadingPlan) {\n      return 'Loading plan...';\n    }\n    if (isLoadingTokenAccounts) {\n      return 'Loading tokens...';\n    }\n    if (isSubscribing) {\n      return 'Subscribing...';\n    }\n    if (connected) {\n      return 'Subscribe';\n    }\n    return 'Connect';\n  };\n\n  const renderSubscriptionPlan = () => {\n    if (!subscriptionPlan) {\n      return null;\n    }\n\n    if (!tokenAccount && connected) {\n      return (\n        <>\n          You don't have{' '}\n          {tokenMeta?.tokenSymbol ||\n            shortAddress(subscriptionPlan.data.token.toBase58())}\n        </>\n      );\n    }\n\n    return (\n      <>\n        <Price>\n          {subscriptionPlan.data.maxAmount.toNumber()}{' '}\n          {tokenMeta?.tokenSymbol || subscriptionPlan.data.token.toBase58()}{' '}\n        </Price>\n        {renderSubscriptionTimeframe(\n          subscriptionPlan.data.subscriptionTimeframe.toNumber(),\n        )}\n      </>\n    );\n  };\n\n  const isDisabled = !subscriptionPlan || isFetching;\n\n  return (\n    <WrapperCard>\n      <Title>Payment</Title>\n      <Rocket className={classNames({ isFetching })} />\n      <Group className={classNames({ isDisabled })}>\n        {renderSubscriptionPlan()}\n      </Group>\n      <SubscribeButton onClick={handleSubscribeClick} disabled={isDisabled}>\n        {renderButtonText()}\n      </SubscribeButton>\n    </WrapperCard>\n  );\n};\n","import React, { FC, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { styled } from '@linaria/react';\nimport classNames from 'classnames';\n\nimport { HiOutlineSelector } from 'react-icons/hi';\n\nconst Wrapper = styled.div`\n  position: relative;\n`;\n\nconst SelectButton = styled.button`\n  display: flex;\n  align-items: center;\n\n  width: 100%;\n  min-height: 38px;\n  padding: 0 5px 0 11px;\n\n  font-size: 14px;\n  font-weight: 400;\n  text-align: left;\n\n  background: #fff;\n  border: 1px rgba(19, 45, 74, 0.12);\n  border-radius: 5px;\n  box-shadow: 0 0 0 1px rgb(19 45 74 / 12%), 0 2px 4px -2px rgb(0 0 0 / 20%);\n  transition: box-shadow 200ms cubic-bezier(0.64, 0, 0.35, 1) 0s;\n  outline: none;\n\n  &:hover {\n    box-shadow: 0 0 0 1px rgb(19 45 74 / 12%), 0 3px 6px -2px rgb(0 0 0 / 20%);\n  }\n`;\n\nconst Value = styled.div`\n  width: 100%;\n  margin-right: 2px;\n\n  color: #364a61;\n`;\n\nconst Placeholder = styled(Value)`\n  color: #96a3b3;\n`;\n\nconst SelectListContainer = styled.div`\n  position: absolute;\n  right: 0;\n  z-index: 1;\n\n  min-width: 100%;\n  margin-top: 8px;\n\n  background: #fff;\n  border: 1px rgba(19, 45, 74, 0.12);\n  border-radius: 5px;\n  box-shadow: rgba(19, 45, 74, 0.12) 0 0 0 1px,\n    rgba(0, 0, 0, 0.14) 0 7px 14px -4px;\n`;\n\nconst SelectList = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  padding: 6px 0;\n  max-height: 288px;\n\n  overflow-y: auto;\n`;\n\nconst SelectOptionText = styled.span`\n  color: #364a61;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 22px;\n  letter-spacing: 0.36px;\n  white-space: nowrap;\n`;\n\nconst SelectOption = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-start;\n\n  min-height: 36px;\n  padding: 0 11px;\n\n  cursor: pointer;\n\n  &:hover {\n    background: #f7f9fc;\n  }\n\n  &.isSelected {\n    background: #f7f9fc;\n\n    ${SelectOptionText} {\n      font-weight: 500;\n    }\n  }\n`;\n\nexport type SelectValueType = string | number;\n\ninterface Props {\n  placeholder: string;\n  selected?: SelectValueType;\n  items: { title?: string; value: SelectValueType }[];\n  onChange: (nextValue: SelectValueType) => void;\n}\n\nexport const Select: FC<Props> = ({\n  placeholder,\n  selected,\n  items,\n  onChange,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const selectRef = useRef<HTMLButtonElement>(null);\n  const selectListRef = useRef<HTMLDivElement>(null);\n\n  const handleAwayClick = (e: MouseEvent) => {\n    if (\n      !selectRef.current?.contains(e.target as HTMLButtonElement) &&\n      !selectListRef.current?.contains(e.target as HTMLDivElement)\n    ) {\n      setIsOpen(false);\n    }\n  };\n\n  useEffect(() => {\n    window.addEventListener('click', handleAwayClick);\n\n    return () => {\n      window.removeEventListener('click', handleAwayClick);\n    };\n  }, []);\n\n  const selectedItem = useMemo(\n    () => items.find((item) => item.value === selected),\n    [selected, items],\n  );\n\n  const handleSelectClick = () => {\n    setIsOpen(!isOpen);\n  };\n\n  const handleOptionClick = (nextValue: SelectValueType) => () => {\n    onChange(nextValue);\n    setIsOpen(false);\n  };\n\n  return (\n    <Wrapper>\n      <SelectButton ref={selectRef} onClick={handleSelectClick}>\n        {selectedItem ? (\n          <Value>{selectedItem.title || selectedItem.value}</Value>\n        ) : (\n          <Placeholder>{placeholder}</Placeholder>\n        )}{' '}\n        <HiOutlineSelector size={20} color=\"#96A3B3\" />\n      </SelectButton>\n      {isOpen ? (\n        <SelectListContainer ref={selectListRef}>\n          <SelectList role=\"listbox\">\n            {items.map(({ title, value }) => (\n              <SelectOption\n                key={value || title}\n                role=\"option\"\n                onClick={handleOptionClick(value)}\n                className={classNames({ isSelected: value === selected })}\n              >\n                <SelectOptionText title={title || String(value)}>\n                  {title || value}\n                </SelectOptionText>\n              </SelectOption>\n            ))}\n          </SelectList>\n        </SelectListContainer>\n      ) : null}\n    </Wrapper>\n  );\n};\n","import { Account, PublicKey, Transaction } from '@solana/web3.js';\nimport nacl from 'tweetnacl';\n\nimport { isDev, localPrivateKey } from 'config';\n\nimport { Wallet, WalletEvent } from './Wallet';\n\n/**\n * Test wallet implementation that uses a private key\n */\nexport class LocalWallet extends Wallet {\n  private account: Account;\n\n  constructor(network: string) {\n    super(network);\n    if (!isDev) {\n      throw new Error('LocalWallet can not be used in production');\n    }\n\n    if (!localPrivateKey) {\n      throw new Error('No local private key in the environment');\n    }\n\n    this.account = new Account(JSON.parse(localPrivateKey));\n\n    // simulate connecting to an external wallet;\n    setImmediate(() => this.emit(WalletEvent.CONNECT));\n  }\n\n  get pubkey(): PublicKey {\n    return this.account.publicKey;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  disconnect(): void {\n    // Nothing to do here\n  }\n\n  async signTransaction(transaction: Transaction): Promise<Transaction> {\n    const message = transaction.serializeMessage();\n    const signature = nacl.sign.detached(message, this.account.secretKey);\n    transaction.addSignature(this.account.publicKey, Buffer.from(signature));\n    return Promise.resolve(transaction);\n  }\n}\n","import { sendAndConfirmTransaction as realSendAndConfirmTransaction } from '@solana/web3.js';\nimport type {\n  Account,\n  Connection,\n  Transaction,\n  TransactionSignature,\n} from '@solana/web3.js';\n\nexport function sendAndConfirmTransaction(\n  title: string,\n  connection: Connection,\n  transaction: Transaction,\n  ...signers: Array<Account>\n): Promise<TransactionSignature> {\n  return realSendAndConfirmTransaction(connection, transaction, signers, {\n    skipPreflight: false,\n    commitment: 'recent',\n    preflightCommitment: 'recent',\n  });\n}\n","// import { Connection } from '@solana/web3.js';\n// import { Wallet } from 'api/wallet/Wallet';\nimport { TOKENS } from '@solana/spl-token-registry';\nimport { WalletType } from 'api/wallet';\nimport { app } from '../app';\nimport { ExtendedCluster } from '../../types/custom';\n\nexport const connectFx = app.createEffect<void, string>();\n\nexport const disconnectFx = app.createEffect<void, void>();\n\nexport const changeCluster = app.createEvent<ExtendedCluster>();\n\nexport const $cluster = app.createStore<ExtendedCluster>('devnet');\n\nexport const clusterPersisted = app.createEvent<any>();\n\nexport const $type = app.createStore<WalletType>(WalletType.SOLLET);\n\nexport const $connected = app.createStore<boolean>(false);\n\nexport const $availableTokens = $cluster.map((cluster) => TOKENS[cluster] || []);\n\n// export const $connection = app.createStore<Connection | null>(null);\n//\n// export const $wallet = app.createStore<Wallet | null>(null);\n","import { createDomain } from 'effector';\nimport { createGate } from 'effector-react';\n\nexport const app = createDomain();\n\nexport const AppGate = createGate();\n","import {\n  AccountInfo,\n  ParsedAccountData,\n  PublicKey,\n  PublicKeyAndAccount,\n} from '@solana/web3.js';\nimport { Numberu64 } from '@solana/spl-token-swap';\nimport { app } from '../app';\nimport { ISubscriptionPlanRecord, ISubscriptionRecord } from './types';\n\nexport const getParsedTokenAccountsByOwnerFx = app.createEffect<\n  {\n    token?: PublicKey;\n  },\n  { pubkey: PublicKey; account: AccountInfo<ParsedAccountData> }[]\n>();\n\nexport const createSubscriptionPlanFx = app.createEffect<\n  {\n    token: PublicKey;\n    subscriptionTimeframe: number;\n    maxAmount: number;\n  },\n  string\n>();\n\nexport const findSubscriptionPlansFx = app.createEffect<\n  void,\n  PublicKeyAndAccount<ISubscriptionPlanRecord>[]\n>();\n\nexport const findSubscriptionPlanFx = app.createEffect<\n  { planAddress: PublicKey },\n  AccountInfo<ISubscriptionPlanRecord> | null\n>();\n\nexport const findSubscriptionsFx = app.createEffect<\n  void,\n  PublicKeyAndAccount<ISubscriptionRecord>[]\n>();\n\nexport const createSubscriptionFx = app.createEffect<\n  {\n    subscriptionPlanAccount: PublicKey;\n    authority: PublicKey;\n    tokenAccount: PublicKey;\n    subscriptionTimeframe: number | Numberu64;\n    maxAmount: number | Numberu64;\n  },\n  string\n>();\n","import React from 'react';\nimport { useStore } from 'effector-react';\nimport { styled } from '@linaria/react';\nimport { $connected } from 'models/wallet';\nimport { Button } from 'components/ui/Button';\nimport { Header } from 'components/common/Header';\nimport { Subscribe } from 'components/common/Subscribe';\nimport { MainContainer } from 'components/common/MainContainer';\nimport { connectAndCreateClicked } from './model';\n\nconst Wrapper = styled.div`\n  min-height: 100%;\n  padding-bottom: 50px;\n\n  background: #fbfbfd;\n`;\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  width: 100%;\n  max-width: 1280px;\n  margin: 0 auto;\n  padding: 0 0 200px;\n`;\n\nconst Hero = styled.div`\n  padding: 120px 0 120px;\n\n  text-align: center;\n`;\n\nconst HeroTitle = styled.h1`\n  margin: 0 0 30px;\n\n  color: #111;\n  font-size: 90px;\n  font-weight: 800;\n  line-height: 1;\n  letter-spacing: -0.05em;\n`;\n\nconst HeroDescription = styled.h3`\n  margin: 0 0 40px;\n\n  color: #666;\n  font-size: 20px;\n  font-weight: 400;\n  line-height: 1.6;\n  letter-spacing: -0.02em;\n`;\n\nconst ButtonsWrapper = styled.div`\n  display: flex;\n  justify-content: center;\n\n  & > :not(:last-child) {\n    margin-right: 24px;\n  }\n`;\n\nconst ButtonStyled = styled(Button)`\n  height: 48px;\n  padding: 0 56px;\n`;\n\nconst ConnectButton = styled(ButtonStyled)`\n  box-shadow: 0 4px 14px 0 rgb(0 118 255 / 39%);\n`;\n\nconst DocumentationButton = styled(ButtonStyled)`\n  box-shadow: 0 4px 14px 0 rgb(0 0 0 / 10%);\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.9);\n    box-shadow: 0 6px 20px rgb(93 93 93 / 23%);\n  }\n`;\n\nconst GitHubA = styled.a`\n  display: inline-block;\n  margin: 40px 0 0;\n`\n\nconst Section = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`;\n\nconst Title = styled.div`\n  margin-bottom: 24px;\n\n  color: #000;\n  font-size: 24px;\n  letter-spacing: -0.47px;\n  font-weight: 600;\n  line-height: 1.5;\n`;\n\nconst SectionContent = styled.div`\n  display: grid;\n  grid-auto-flow: column;\n  grid-gap: 24px;\n`;\n\nconst SectionColumn = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\nexport const Home = () => {\n  const connected = useStore($connected);\n\n  return (\n    <Wrapper>\n      <Header showConnect />\n      <MainContainer>\n        <Container>\n          <Hero>\n            <HeroTitle>\n              The Recurring Payments <br /> for Solana\n            </HeroTitle>\n            <HeroDescription>\n              SollPay gives you the experience to accept recurring payments in\n              wrapped tokens by 100% non-custodial way\n            </HeroDescription>\n            <ButtonsWrapper>\n              <ConnectButton primary onClick={connectAndCreateClicked}>\n                {connected ? 'Sign In' : 'Connect and Sign In'}\n              </ConnectButton>\n              <a href=\"#\">\n                <DocumentationButton hollow>Documentation</DocumentationButton>\n              </a>\n            </ButtonsWrapper>\n            <GitHubA href=\"#\">GitHub</GitHubA>\n          </Hero>\n\n          <Section>\n            <Title>Demo</Title>\n            <SectionContent>\n              <Subscribe planAddress=\"5eg3zjHtV7SkaxsHUJtxLeMDte2SFF1rV7ooGt4YwXSr\" />\n              <SectionColumn>\n                <HeroDescription>\n                  Make approve of transactions to an address every X days. You\n                  can manage your subscriptions after Sign In.\n                </HeroDescription>\n              </SectionColumn>\n            </SectionContent>\n          </Section>\n        </Container>\n      </MainContainer>\n    </Wrapper>\n  );\n};\n","import React from 'react';\n\nexport const NotFound = () => <div>Page not found</div>;\n","import React, { FC } from 'react';\n\nimport { styled } from '@linaria/react';\nimport { Link } from 'react-router-dom';\nimport { Header } from 'components/common/Header';\nimport { Card } from 'components/common/Card';\nimport leftImg from './left.png';\nimport rightImg from './right.png';\n\nconst Wrapper = styled.div`\n  height: 100%;\n`;\n\nconst Container = styled.div`\n  display: flex;\n  justify-content: center;\n\n  margin: 48px auto 0;\n`;\n\nconst CardStyled = styled(Card)`\n  display: flex;\n\n  width: 800px;\n  min-height: 400px;\n`;\n\nconst ColumnLink = styled(Link)`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n\n  &:hover {\n  }\n`;\n\nconst LeftColumnLink = styled(ColumnLink)``;\n\nconst LeftPic = styled.div`\n  width: 194px;\n  height: 200px;\n\n  background: url('${leftImg}') no-repeat 50% 50%;\n  background-size: 194px 200px;\n`;\n\nconst Delimiter = styled.div`\n  width: 1px;\n\n  background: #eaeaea;\n`;\n\nconst RightColumnLink = styled(ColumnLink)``;\n\nconst RightPic = styled.div`\n  width: 209px;\n  height: 200px;\n\n  background: url('${rightImg}') no-repeat 50% 50%;\n  background-size: 209px 200px;\n`;\n\nconst Title = styled.div`\n  margin-top: 24px;\n\n  color: #000;\n  font-size: 24px;\n  letter-spacing: -0.47px;\n  font-weight: 600;\n  line-height: 1.5;\n`;\n\nconst Description = styled.div`\n  margin: 24px 0;\n  color: #666;\n  font-size: 16px;\n  font-weight: 400;\n  line-height: 1.6;\n`;\n\nexport const Select: FC = () => {\n  return (\n    <Wrapper>\n      <Header />\n      <Container>\n        <CardStyled>\n          <LeftColumnLink to=\"/user\">\n            <LeftPic />\n            <Title>User</Title>\n            <Description>Manage your subscriptions</Description>\n          </LeftColumnLink>\n          <Delimiter />\n          <RightColumnLink to=\"/customer\">\n            <RightPic />\n            <Title>Customer</Title>\n            <Description>Manage your subscribers</Description>\n          </RightColumnLink>\n        </CardStyled>\n      </Container>\n    </Wrapper>\n  );\n};\n","import React, { lazy, useMemo } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { renderRoutes, RouteConfig } from 'react-router-config';\n\nimport { useStore } from 'effector-react';\n\nimport { Home } from 'pages/home';\nimport { NotFound } from 'pages/notFound';\nimport { Select } from 'pages/select';\nimport { $connected } from 'models/wallet';\n\nexport const makeRoutes = (isAuth: boolean): RouteConfig[] =>\n  [\n    {\n      path: '/',\n      exact: true,\n      component: Home,\n    },\n    {\n      path: `/select`,\n      exact: true,\n      needAuth: true,\n      component: Select,\n    },\n    {\n      path: `/subscribe/:planAddress`,\n      exact: true,\n      component: lazy(() => import('pages/subscribe')),\n    },\n    {\n      path: `/customer`,\n      exact: true,\n      needAuth: true,\n      component: () => <Redirect to=\"/customer/subscriptions\" />,\n    },\n    {\n      path: `/customer/plans`,\n      exact: true,\n      needAuth: true,\n      component: lazy(() => import('pages/customer/plans')),\n    },\n    {\n      path: `/customer/subscriptions`,\n      exact: true,\n      needAuth: true,\n      component: lazy(() => import('pages/customer/subscriptions')),\n    },\n    {\n      path: `/user`,\n      exact: true,\n      needAuth: true,\n      component: () => <Redirect to=\"/user/subscriptions\" />,\n    },\n    {\n      path: `/user/subscriptions`,\n      exact: true,\n      needAuth: true,\n      component: lazy(() => import('pages/user/subscriptions')),\n    },\n    {\n      path: '*',\n      component: NotFound,\n    },\n  ].map((route) => {\n    if (route.needAuth && route.needAuth !== isAuth) {\n      route.component = () => <Redirect to=\"/\" />;\n      return route;\n    }\n\n    return route;\n  });\n\nexport const Pages = () => {\n  // TODO: Cannot update a component (`Pages`) while rendering a different component\n  const connected = useStore($connected);\n\n  return useMemo(() => renderRoutes(makeRoutes(connected)), [connected]);\n};\n","/* eslint-disable react/jsx-props-no-spreading */\nimport React, {\n  createRef,\n  FC,\n  lazy,\n  LazyExoticComponent,\n  RefObject,\n  Suspense,\n  useState,\n} from 'react';\n\nimport { styled } from '@linaria/react';\nimport { last } from 'ramda';\nimport { useStore } from 'effector-react';\nimport { ModalComponentType, ModalState } from 'models/modals/types';\nimport { $modals, closeModalFx } from 'models/modals';\nimport { MODAL_PLAN } from './constants';\n\nconst Wrapper = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 30;\n\n  width: 100vw;\n  height: 100vh;\n`;\n\nconst ModalContainer = styled.div`\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 1;\n\n  overflow-y: auto;\n  overscroll-behavior: none;\n\n  /* Above background */\n  &:last-child {\n    z-index: 2;\n  }\n`;\n\nconst ModalWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-height: 100%;\n  padding: 10px 0;\n`;\n\nconst ModalBackground = styled.div`\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 2;\n\n  background-color: rgba(0, 0, 0, 0.6);\n\n  user-select: none;\n`;\n\nconst modalsMap = new Map<string, LazyExoticComponent<any>>([\n  [MODAL_PLAN, lazy(() => import('components/modals/Plan'))],\n]);\n\nexport const ModalManager: FC = () => {\n  const [modalsRefs, setModalsRefs] = useState<{\n    [modalId: string]: RefObject<ModalComponentType>;\n  }>({});\n  const modals = useStore($modals);\n\n  const closeTopModal = async () => {\n    const modal = last(modals);\n    if (!modal) {\n      return;\n    }\n\n    const { modalId } = modal;\n\n    const modalRef = modalsRefs[modalId];\n    if (modalRef.current?.canClose && !(await modalRef.current.canClose())) {\n      return;\n    }\n\n    closeModalFx({ modalId });\n  };\n\n  const handleWrapperClick = (e: React.MouseEvent<HTMLDivElement>) => {\n    // handle click only on element\n    if (e.target !== e.currentTarget) {\n      return;\n    }\n\n    closeTopModal();\n  };\n\n  const getReadyDialogs = () => {\n    const dialogs: (ModalState & {\n      ModalComponent: LazyExoticComponent<any>;\n    })[] = [];\n\n    for (const { modalType, modalId, props } of modals) {\n      const ModalComponent = modalsMap.get(modalType);\n      if (ModalComponent) {\n        dialogs.push({\n          modalType,\n          modalId,\n          props,\n          ModalComponent,\n        });\n      }\n    }\n\n    return dialogs;\n  };\n\n  const dialogsInfo = getReadyDialogs();\n\n  const dialogs = dialogsInfo.map(({ modalId, props, ModalComponent }) => {\n    let modalRef = modalsRefs[modalId];\n\n    if (!modalRef) {\n      modalRef = createRef();\n      setModalsRefs((state) => ({\n        ...state,\n        [modalId]: modalRef,\n      }));\n    }\n\n    return (\n      <Suspense fallback={null} key={modalId}>\n        <ModalContainer>\n          <ModalWrapper onClick={handleWrapperClick}>\n            <ModalComponent\n              {...props}\n              modalId={modalId}\n              modalRef={modalRef}\n              close={(result: any) => closeModalFx({ modalId, result })}\n            />\n          </ModalWrapper>\n        </ModalContainer>\n      </Suspense>\n    );\n  });\n\n  if (dialogs.length > 0) {\n    return (\n      <Wrapper>\n        <ModalBackground />\n        {dialogs}\n      </Wrapper>\n    );\n  }\n\n  return null;\n};\n","import React, { Suspense } from 'react';\nimport { Router } from 'react-router';\nimport { useGate } from 'effector-react';\n\nimport dayjs from 'dayjs';\nimport relativeTime from 'dayjs/plugin/relativeTime';\nimport localizedFormat from 'dayjs/plugin/localizedFormat';\nimport { AppGate } from 'models/app';\nimport { history } from 'lib/routing';\nimport { Pages } from './routes';\nimport { ModalManager } from './components/common/ModalManager';\n\ndayjs.extend(relativeTime);\ndayjs.extend(localizedFormat);\n\nexport const App: React.FC = () => {\n  useGate(AppGate);\n\n  return (\n    <>\n      <Router history={history}>\n        <Suspense fallback={null}>\n          <Pages />\n        </Suspense>\n      </Router>\n      <ModalManager />\n    </>\n  );\n};\n","import { $connected, changeCluster } from '../wallet';\nimport { app } from './index';\n\napp.onCreateStore((newStore) => {\n  // Change cluster reset all store exclude $connected because of route pass user to home page\n  if (newStore !== $connected) {\n    newStore.reset(changeCluster);\n  }\n});\n\napp.onCreateEffect((newEffect) => {\n  newEffect.failData.watch((payload) => console.error(payload));\n});\n","import {\n  Account,\n  PublicKey,\n  SystemProgram,\n  TransactionInstruction,\n} from '@solana/web3.js';\n\nimport { TOKEN_PROGRAM_ID } from '@solana/spl-token';\nimport { SOLLPAY_FEE_ACCOUNT, SOLLPAY_PROGRAM_ID } from 'constants/common';\nimport { getWallet, makeTransaction, sendTransaction } from 'api/wallet';\nimport { getConnection } from 'api/connection';\nimport { SollPay } from 'lib/sollpay';\nimport { SubscriptionPlanLayout } from 'lib/sollpay/layouts/subscriptionPlan';\nimport { createSubscriptionPlanFx } from '..';\n\ncreateSubscriptionPlanFx.use(\n  async ({ token, subscriptionTimeframe, maxAmount }) => {\n    const connection = getConnection();\n    const wallet = getWallet().pubkey;\n    const subscriptionPlanAccount = new Account();\n\n    const [authority, nonce] = await PublicKey.findProgramAddress(\n      [subscriptionPlanAccount.publicKey.toBuffer()],\n      SOLLPAY_PROGRAM_ID,\n    );\n\n    const instructions: TransactionInstruction[] = [];\n\n    // Allocate memory for the account\n    const balanceNeeded = await SollPay.getMinBalanceRentForExemptSubscriptionPlan(\n      connection,\n    );\n\n    instructions.push(\n      SystemProgram.createAccount({\n        fromPubkey: wallet,\n        newAccountPubkey: subscriptionPlanAccount.publicKey,\n        lamports: balanceNeeded,\n        space: SubscriptionPlanLayout.span,\n        programId: SOLLPAY_PROGRAM_ID,\n      }),\n    );\n\n    instructions.push(\n      SollPay.createSubscriptionPlanInstruction(\n        subscriptionPlanAccount,\n        authority,\n        token,\n        SOLLPAY_FEE_ACCOUNT,\n        TOKEN_PROGRAM_ID,\n        SOLLPAY_PROGRAM_ID,\n        wallet,\n        nonce,\n        subscriptionTimeframe,\n        maxAmount,\n      ),\n    );\n\n    const transaction = await makeTransaction(instructions, [\n      subscriptionPlanAccount,\n    ]);\n    return sendTransaction(transaction);\n  },\n);\n","import {\n  Account,\n  SystemProgram,\n  TransactionInstruction,\n} from '@solana/web3.js';\nimport { Token as SPLToken, TOKEN_PROGRAM_ID } from '@solana/spl-token';\nimport { getConnection } from 'api/connection';\nimport { getWallet, makeTransaction, sendTransaction } from 'api/wallet';\nimport { SOLLPAY_FEE_ACCOUNT, SOLLPAY_PROGRAM_ID } from 'constants/common';\nimport { createSubscriptionFx } from '..';\nimport { SollPay, SubscriptionLayout } from 'lib/sollpay';\n\ncreateSubscriptionFx.use(\n  async ({\n    subscriptionPlanAccount,\n    authority,\n    tokenAccount,\n    subscriptionTimeframe,\n    maxAmount,\n  }) => {\n    const connection = getConnection();\n    const wallet = getWallet().pubkey;\n    const subscriptionAccount = new Account();\n\n    const instructions: TransactionInstruction[] = [];\n\n    instructions.push(\n      SPLToken.createApproveInstruction(\n        TOKEN_PROGRAM_ID,\n        tokenAccount,\n        authority,\n        getWallet().pubkey,\n        [],\n        1000000000, // TODO: find right maximum value\n      ),\n    );\n\n    // Allocate memory for the account\n    const balanceNeeded = await SollPay.getMinBalanceRentForExemptSubscription(\n      connection,\n    );\n\n    instructions.push(\n      SystemProgram.createAccount({\n        fromPubkey: wallet,\n        newAccountPubkey: subscriptionAccount.publicKey,\n        lamports: balanceNeeded,\n        space: SubscriptionLayout.span,\n        programId: SOLLPAY_PROGRAM_ID,\n      }),\n    );\n\n    instructions.push(\n      SollPay.createSubscriptionInstruction(\n        subscriptionAccount,\n        subscriptionPlanAccount,\n        tokenAccount,\n        TOKEN_PROGRAM_ID,\n        SOLLPAY_FEE_ACCOUNT,\n        SOLLPAY_PROGRAM_ID,\n        subscriptionTimeframe,\n        maxAmount,\n      ),\n    );\n\n    const transaction = await makeTransaction(instructions, [\n      subscriptionAccount,\n    ]);\n    return sendTransaction(transaction);\n  },\n);\n","import { getConnection } from 'api/connection';\nimport { parseSubscriptionPlanData } from 'lib/sollpay/layouts/subscriptionPlan';\nimport { findSubscriptionPlanFx } from '..';\n\nfindSubscriptionPlanFx.use(async ({ planAddress }) => {\n  const connection = getConnection();\n  const info = await connection.getAccountInfo(planAddress);\n  if (!info) {\n    return null;\n  }\n\n  return {\n    ...info,\n    data: parseSubscriptionPlanData(info.data),\n  };\n});\n","import { TOKEN_PROGRAM_ID } from '@solana/spl-token';\nimport { getConnection } from 'api/connection';\nimport { getWallet } from 'api/wallet';\nimport { getParsedTokenAccountsByOwnerFx } from '..';\n\ngetParsedTokenAccountsByOwnerFx.use(async ({ token }) => {\n  const connection = getConnection();\n  const wallet = getWallet().pubkey;\n\n  const result = await connection.getParsedTokenAccountsByOwner(wallet, {\n    programId: TOKEN_PROGRAM_ID,\n    mint: token,\n  });\n\n  return result.value.map(account => account);\n});\n","import { forward } from 'effector';\nimport { persist } from 'effector-storage/local';\nimport * as WalletAPI from 'api/wallet';\nimport { WalletEvent } from 'api/wallet/Wallet';\n\nimport {\n  $cluster,\n  $connected,\n  $type,\n  changeCluster,\n  connectFx,\n  disconnectFx,\n} from '.';\n\nconnectFx.use(async () => {\n  const cluster = $cluster.getState();\n  const type = $type.getState();\n  const wallet = await WalletAPI.connect(cluster, type);\n\n  wallet.on(WalletEvent.DISCONNECT, () => {\n    disconnectFx();\n    console.error('Wallet disconnected');\n  });\n\n  wallet.on(WalletEvent.CONFIRMED, ({ transactionSignature }) =>\n    console.info(`Confirmed: ${transactionSignature}`),\n  );\n\n  console.info('Wallet connected');\n\n  return wallet.pubkey.toBase58();\n});\n\ndisconnectFx.use(() => {\n  WalletAPI.disconnect();\n  console.error('Wallet disconnected');\n});\n\n$cluster.on(changeCluster, (_, cluster) => cluster);\n\n$connected.on(connectFx.done, () => true).on(disconnectFx, () => false);\n\nforward({\n  from: changeCluster,\n  to: [connectFx],\n});\n\npersist({\n  store: $cluster,\n  key: 'cluster',\n});\n","import { closeModal, $modals, closeModalFx, openModalFx, openModal } from '.';\n\nconst promises = new Map();\nlet modalId = 0;\n\ncloseModalFx.use(({ modalId, result }): void => {\n  if (!modalId) {\n    throw new Error('Trying to hide modal without modalId');\n  }\n\n  const dialogInfo = promises.get(modalId);\n\n  if (dialogInfo) {\n    dialogInfo.resolve(result);\n    promises.delete(modalId);\n  }\n\n  closeModal({ modalId });\n});\n\nopenModalFx.use(\n  ({ modalType, props }): Promise<unknown> => {\n    const modals = $modals.getState();\n\n    if (modals.some((modal) => modal.modalType === modalType)) {\n      // TODO: custom type of Error\n      throw new Error(`Dublicate of modal ${modalType}`);\n    }\n\n    modalId = ++modalId;\n\n    openModal({ modalType, modalId, props });\n\n    const promise = new Promise((resolve) => {\n      promises.set(modalId, {\n        modalId,\n        resolve,\n      });\n    });\n\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    promise.modalId = modalId;\n\n    return promise;\n  },\n);\n\n$modals\n  .on(closeModal, (state, payload) =>\n    state.filter((dialog) => dialog.modalId !== payload.modalId),\n  )\n  .on(openModal, (state, payload) => state.concat(payload));\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { createInspector } from 'effector-logger/inspector';\n\nimport { App } from './App';\nimport { reportWebVitals } from './reportWebVitals';\nimport './models/init';\nimport { css } from '@linaria/core';\nimport { ress } from './styles/ress';\n\ncreateInspector();\n\nexport const globals = css`\n  :global() {\n    ${ress}\n\n    html,\n    body,\n    #root {\n      min-height: 0;\n    }\n\n    body {\n      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI',\n        'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans',\n        'Helvetica Neue', sans-serif;\n      font-feature-settings: 'kern';\n      text-rendering: optimizeLegibility;\n      -webkit-font-smoothing: antialiased;\n    }\n\n    a {\n      text-decoration: none;\n      color: inherit;\n    }\n  }\n`;\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.querySelector('#root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import { ReportHandler } from 'web-vitals';\n\nexport const reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n","import {\n  Account,\n  Commitment,\n  Connection,\n  PublicKey,\n  Transaction,\n  TransactionInstruction,\n  TransactionInstructionCtorFields,\n} from '@solana/web3.js';\n\nimport { postTransactionSleepMS } from 'config';\nimport { sleep } from 'utils/common';\n\nimport { ExtendedCluster } from 'types/custom';\nimport {\n  confirmTransaction,\n  DEFAULT_COMMITMENT,\n  getConnection,\n  getNetwork,\n} from '../connection';\nimport { LocalWallet } from './LocalWallet';\nimport { SolletWallet } from './SolletWallet';\nimport { Wallet, WalletEvent } from './Wallet';\n\nconst POST_TRANSACTION_SLEEP_MS = postTransactionSleepMS || 500;\n\n/**\n * API for connecting to and interacting with a wallet\n */\n\n// singleton wallet for the app.\n// A user can be connected to only one wallet at a time.\nlet wallet: Wallet | null;\nlet connection: Connection | null;\n\nconst ERROR_CONNECT_FIRST = 'Connect first';\n\n// eslint-disable-next-line no-shadow\nexport enum WalletType {\n  MANUAL,\n  SOLLET,\n  BONFIDA,\n  LOCAL,\n}\n\nconst createWallet = (type: WalletType, cluster: ExtendedCluster): Wallet => {\n  const network = getNetwork(cluster);\n  switch (type) {\n    case WalletType.LOCAL:\n      return new LocalWallet(network);\n    case WalletType.SOLLET:\n      return new SolletWallet(network);\n    case WalletType.BONFIDA:\n      return new SolletWallet(network, 'https://bonfida.com/wallet');\n    default:\n      return new SolletWallet(network);\n  }\n};\n\nexport const connect = async (\n  cluster: ExtendedCluster,\n  type: WalletType,\n): Promise<Wallet> => {\n  const newWallet = createWallet(type, cluster);\n\n  // assign the singleton wallet.\n  // Using a separate variable to simplify the type definitions\n  wallet = newWallet;\n  connection = getConnection(cluster);\n\n  // connect is done once the wallet reports that it is connected.\n  return new Promise((resolve) => {\n    newWallet.on(WalletEvent.CONNECT, () => resolve(newWallet));\n  });\n};\n\nexport const disconnect = (): void => wallet?.disconnect();\n\nexport const makeTransaction = async (\n  instructions: (TransactionInstruction | TransactionInstructionCtorFields)[],\n  signers: Account[] = [],\n): Promise<Transaction> => {\n  if (!wallet || !connection) {\n    throw new Error(ERROR_CONNECT_FIRST);\n  }\n\n  const { blockhash: recentBlockhash } = await connection.getRecentBlockhash();\n\n  const signatures = [{ publicKey: wallet.pubkey }, ...signers];\n  const transaction = new Transaction({\n    recentBlockhash,\n    signatures,\n  });\n  transaction.add(...instructions);\n\n  // if there are any cosigners (other than the current wallet)\n  // sign the transaction\n  if (signers.length > 0) {\n    transaction.partialSign(...signers);\n  }\n\n  return transaction;\n};\n\ninterface SendOptions {\n  commitment: Commitment;\n  preflightCommitment: Commitment;\n}\n\nconst defaultSendOptions = {\n  commitment: DEFAULT_COMMITMENT,\n  preflightCommitment: DEFAULT_COMMITMENT,\n};\n\nasync function awaitConfirmation(\n  signature: string,\n  commitment: 'max' | 'recent' | 'root' | 'single' | 'singleGossip' | undefined,\n) {\n  console.log(`Submitted transaction ${signature}, awaiting confirmation`);\n  await confirmTransaction(signature, commitment);\n  console.log(`Transaction ${signature} confirmed`);\n\n  if (wallet) {\n    wallet.emit(WalletEvent.CONFIRMED, { transactionSignature: signature });\n  }\n\n  // workaround for a known solana web3 bug where\n  // the state obtained from the http endpoint and the websocket are out of sync\n  await sleep(POST_TRANSACTION_SLEEP_MS);\n  return signature;\n}\n\nexport const sendTransaction = async (\n  transaction: Transaction,\n  {\n    commitment = defaultSendOptions.commitment,\n    preflightCommitment = defaultSendOptions.preflightCommitment,\n  }: Partial<SendOptions> = defaultSendOptions,\n): Promise<string> => {\n  if (!wallet || !connection) {\n    throw new Error(ERROR_CONNECT_FIRST);\n  }\n\n  console.log('Sending signature request to wallet');\n  const signed = await wallet.sign(transaction);\n  console.log('Got signature, submitting transaction');\n  const signature = await connection.sendRawTransaction(signed.serialize(), {\n    preflightCommitment,\n  });\n\n  return awaitConfirmation(signature, commitment);\n};\n\nexport const getWallet = (): Wallet => {\n  if (!wallet || !connection) {\n    throw new Error('notification.error.noWallet');\n  }\n\n  return wallet;\n};\n\nexport const getBalance = (publicKey: PublicKey): Promise<number> => {\n  if (!wallet || !connection) {\n    throw new Error(ERROR_CONNECT_FIRST);\n  }\n\n  return connection.getBalance(publicKey);\n};\n\nexport const getMinimumBalanceForRentExemption = (\n  length: number,\n): Promise<number> => {\n  if (!wallet || !connection) {\n    throw new Error(ERROR_CONNECT_FIRST);\n  }\n\n  return connection.getMinimumBalanceForRentExemption(length);\n};\n","import SolletWalletAdapter from '@project-serum/sol-wallet-adapter';\nimport { PublicKey, Transaction } from '@solana/web3.js';\n\nimport { Wallet, WalletEvent } from './Wallet';\n\nconst DEFAULT_PROVIDER = 'https://www.sollet.io';\n\n/**\n * Wallet implementation for the sollet.io wallet.\n * It opens a popup browser window that prompts a user\n * to create and connect a simple web wallet.\n */\nexport class SolletWallet extends Wallet {\n  private solletWallet: SolletWalletAdapter;\n\n  constructor(network: string, provider: string = DEFAULT_PROVIDER) {\n    super(network);\n    this.solletWallet = new SolletWalletAdapter(provider, network);\n\n    // once the sollet wallet emits a connect or disconnect event, pass it on\n    this.solletWallet.on(WalletEvent.CONNECT, () => this.emit(WalletEvent.CONNECT));\n    this.solletWallet.on(WalletEvent.DISCONNECT, () => this.emit(WalletEvent.DISCONNECT));\n\n    void this.solletWallet.connect();\n  }\n\n  get pubkey(): PublicKey {\n    return this.solletWallet.publicKey;\n  }\n\n  disconnect(): void {\n    this.solletWallet.disconnect();\n  }\n\n  signTransaction(transaction: Transaction): Promise<Transaction> {\n    return this.solletWallet.signTransaction(transaction);\n  }\n}\n","import * as BufferLayout from 'buffer-layout';\n\n/**\n * Layout for a public key\n */\nexport const publicKey = (property = 'publicKey'): BufferLayout.Layout => {\n  return BufferLayout.blob(32, property);\n};\n\n/**\n * Layout for a 64bit unsigned value\n */\nexport const uint64 = (property = 'uint64'): BufferLayout.Layout => {\n  return BufferLayout.blob(8, property);\n};\n","import {\n  clusterApiUrl,\n  Commitment,\n  Connection,\n  SignatureResult,\n} from '@solana/web3.js';\nimport { identity, memoizeWith } from 'ramda';\n\nimport { ExtendedCluster } from 'types/custom';\nimport { defaultCommitment } from 'config';\n\nimport { retryableProxy } from './utils/retryableProxy';\n\nexport const LOCALNET_URL = 'http://localhost:8899';\n// const TICK = 5000;\n\n// The default time to wait when confirming a transaction.\nexport const DEFAULT_COMMITMENT: Commitment = defaultCommitment;\n\nlet currentCluster: ExtendedCluster;\n\n// Since connection objects include state, we memoise them here per network\nconst createConnection = memoizeWith<(network: string) => Connection>(\n  identity,\n  (network) => {\n    const connection = new Connection(network, DEFAULT_COMMITMENT);\n\n    // Due to an issue with the solana back-end relating to CORS headers on 429 responses\n    // Rate-limiting responses are not retried correctly. Adding this proxy fixes this.\n    const proxiedFunctions = [\n      'getBalance',\n      'getAccountInfo',\n      'getParsedAccountInfo',\n      'getParsedProgramAccounts',\n      'getParsedTokenAccountsByOwner',\n      'getRecentBlockhash',\n      'sendTransaction',\n      'sendRawTransaction',\n      'requestAirdrop',\n    ];\n    proxiedFunctions.forEach((fnName) => {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      connection[fnName] = retryableProxy(connection[fnName]);\n    });\n\n    return connection;\n  },\n);\n\nexport const getNetwork = (cluster: ExtendedCluster): string => {\n  if (cluster === 'localnet') {\n    return LOCALNET_URL;\n  }\n\n  if (cluster === 'mainnet-beta') {\n    return 'https://solana-api.projectserum.com/';\n  }\n\n  return clusterApiUrl(cluster);\n};\n\nexport const getConnection = (cluster?: ExtendedCluster): Connection => {\n  if (cluster) {\n    currentCluster = cluster;\n  }\n\n  const selectedCluster = cluster || currentCluster;\n\n  const network = getNetwork(selectedCluster);\n  return createConnection(network);\n};\n\nexport const confirmTransaction = (\n  signature: string,\n  commitment?: Commitment,\n): Promise<SignatureResult> => {\n  const connection = getConnection();\n  const confirmViaSocket = new Promise<SignatureResult>((resolve) =>\n    connection.onSignature(signature, (signatureResult) => {\n      console.log('Confirmation via socket:', signatureResult);\n      resolve(signatureResult);\n    }),\n  );\n\n  const confirmViaHttp = connection\n    .confirmTransaction(signature, commitment || DEFAULT_COMMITMENT)\n    .then((signatureResult) => {\n      console.log('Confirmation via http:', signatureResult);\n      return signatureResult.value;\n    });\n\n  return Promise.race([confirmViaHttp, confirmViaSocket]);\n};\n\n// type EpochCallback = (epochInfo: EpochInfo) => void;\n// export const listenToEpoch = (cluster: ExtendedCluster, callback: EpochCallback): void => {\n//   const connection = getConnection();\n//\n//   setInterval(() => {\n//     connection.getEpochInfo(DEFAULT_COMMITMENT).then(callback);\n//   }, TICK);\n// };\n","import { mergeLeft } from 'ramda';\n\nimport { sleep } from 'utils/common';\n\ninterface RetryOptions {\n  count: number;\n  intervalMS: number;\n  backoutMultiplier: number;\n}\n\nconst defaultRetryOptions: RetryOptions = {\n  // max number of retries\n  count: 5,\n  intervalMS: 200,\n  // every retry, multiply the interval by this amount\n  backoutMultiplier: 1.5,\n};\n\ninterface GenericAsyncFunction<U, R> {\n  (...args: Array<U>): Promise<R>;\n}\n\n/**\n * Creates a Proxy wraps the function in a retry function.\n * This should be only used if the function is idempotent, i.e. retrying should\n * return the same value and have no side-effects.\n *\n * @param fn\n * @param retryOptions\n */\nexport const retryableProxy = <U, R>(\n  fn: GenericAsyncFunction<U, R>,\n  retryOptions: Partial<RetryOptions> = defaultRetryOptions,\n): GenericAsyncFunction<U, R> => {\n  // combine the passed in options with default options\n  const options = mergeLeft(retryOptions, defaultRetryOptions);\n\n  const retryReducer = <T>(\n    target: GenericAsyncFunction<U, T>,\n    thisArg: unknown,\n    argArray: Array<U>,\n  ) => async (\n    previousValue: Promise<T>,\n    currentValue: Promise<T>,\n    currentIndex: number,\n  ): Promise<T> => {\n    // eslint-disable-next-line unicorn/consistent-function-scoping\n    const call = async () => target.apply(thisArg, argArray);\n\n    // if it hasn't been called yet, call the function\n    if (!previousValue) {\n      return call();\n    }\n\n    //  if it has been called, and failed, catch the error, wait and retry\n    return previousValue.catch((error) => {\n      const sleepMs =\n        options.intervalMS * options.backoutMultiplier ** currentIndex;\n      console.error(error);\n      console.log(\n        `Retrying after ${sleepMs}ms. (Retried ${currentIndex} times)`,\n      );\n\n      return sleep(sleepMs).then(call);\n    });\n  };\n\n  return new Proxy(fn, {\n    // trap the \"apply\" call to the proxied function,\n    // in other words, trap the function call itself\n    apply: (target, thisArg, argArray) => {\n      // reduce over the maximum number of retries.\n      // if any of them pass, the code will short-circuit and skip the rest\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return,@typescript-eslint/no-unsafe-assignment,@typescript-eslint/no-unsafe-call,@typescript-eslint/no-unsafe-member-access\n      return [...new Array(options.count)]\n        .reduce(retryReducer(target, thisArg, argArray))\n        .catch((error: Error) => {\n          console.error('No more retries, throwing.');\n          throw error;\n        });\n    },\n  });\n};\n","import { PublicKey, Transaction } from '@solana/web3.js';\nimport EventEmitter from 'eventemitter3';\n\n// eslint-disable-next-line no-shadow\nexport enum WalletEvent {\n  CONNECT = 'connect',\n  DISCONNECT = 'disconnect',\n  SIGNED = 'signed',\n  CONFIRMED = 'confirmed',\n}\n\n/**\n * Abstract wallet implementation. Any wallet connection,\n * e.g. browser extension, hardware wallet, web wallet etc,\n * is a separate implementation of this.\n */\nexport abstract class Wallet extends EventEmitter {\n  private network: string;\n\n  protected constructor(network: string) {\n    super();\n    this.network = network;\n  }\n\n  abstract get pubkey(): PublicKey;\n\n  abstract disconnect(): void;\n\n  /**\n   * Sign the transaction, and emit a \"signed\" event\n   * @param transaction\n   */\n  async sign(transaction: Transaction): Promise<Transaction> {\n    const signedTransaction = await this.signTransaction(transaction);\n    this.emit(WalletEvent.SIGNED, { transaction: signedTransaction });\n\n    return signedTransaction;\n  }\n\n  /**\n   * Delegate to the underlying implementation to sign the transaction\n   * @param transaction\n   * @protected\n   */\n  protected abstract signTransaction(transaction: Transaction): Promise<Transaction>;\n}\n","import { PublicKey } from '@solana/web3.js';\n\nexport const SOLLPAY_PROGRAM_ID = new PublicKey(\n  '359yyEjBXTGySfXnraGfS74tP2sTH4bZiPxErLvL3VqE',\n);\n\nexport const SOLLPAY_FEE_ACCOUNT = new PublicKey(\n  '7WCEUck5xmRLKrq1PrvQWxNNNafrsbbNv1dABns83RtZ',\n);\n","import BufferLayout from 'buffer-layout';\nimport { PublicKey } from '@solana/web3.js';\nimport { u64 } from '@solana/spl-token';\nimport { ISubscriptionPlanRecord } from 'models/connection/types';\nimport { publicKey, uint64 } from '../layout';\n\nexport const SubscriptionPlanLayout = BufferLayout.struct([\n  BufferLayout.u8('isInitialized'),\n  BufferLayout.u8('nonce'),\n  publicKey('owner'),\n  publicKey('authority'),\n  publicKey('token'),\n  uint64('subscriptionTimeframe'),\n  uint64('maxAmount'),\n]);\n\nexport function parseSubscriptionPlanData(\n  data: Buffer,\n): ISubscriptionPlanRecord {\n  const accountInfo = SubscriptionPlanLayout.decode(data);\n  accountInfo.isInitialized = accountInfo.isInitialized !== 0;\n  accountInfo.owner = new PublicKey(accountInfo.owner);\n  accountInfo.authority = new PublicKey(accountInfo.authority);\n  accountInfo.token = new PublicKey(accountInfo.token);\n  accountInfo.subscriptionTimeframe = u64.fromBuffer(\n    accountInfo.subscriptionTimeframe,\n  );\n  accountInfo.maxAmount = u64.fromBuffer(accountInfo.maxAmount);\n\n  return accountInfo;\n}\n","import { app } from 'models/app';\nimport { ModalsState, ModalState } from './types';\n\nexport const $modals = app.createStore<ModalsState>([]);\n\nexport const closeModalFx = app.createEffect<\n  {\n    modalId: number;\n    result?: any;\n  },\n  void\n>();\n\nexport const closeModal = app.createEvent<{ modalId: number }>();\n\nexport const openModalFx = app.createEffect<\n  {\n    modalType: string;\n    props?: any;\n  },\n  Promise<unknown>\n>();\n\nexport const openModal = app.createEvent<ModalState>();\n","// the default commitment uesd by the Solana web3 connection when checking the blockchain state\nimport { Commitment } from '@solana/web3.js';\n\nexport const isDev =\n  process.env.NODE_ENV === 'development' || process.env.NODE_ENV === 'test';\n\n// Can be used in development mode only\nexport const localPrivateKey =\n  isDev && process.env.APP_LOCAL_WALLET_PRIVATE_KEY;\n\nexport const defaultCommitment: Commitment =\n  (process.env.DEFAULT_COMMITMENT as Commitment) || 'singleGossip';\n\n// the amount of time to sleep after sending a transaction\n// in order to work around a known solana web3 bug\nexport const postTransactionSleepMS = Number(\n  process.env.POST_TRANSACTION_SLEEP_MS,\n);\n","import BufferLayout from 'buffer-layout';\nimport { PublicKey } from '@solana/web3.js';\nimport { u64 } from '@solana/spl-token';\nimport { ISubscriptionRecord } from 'models/connection/types';\nimport { publicKey, uint64 } from '../layout';\n\nexport const SubscriptionLayout = BufferLayout.struct([\n  BufferLayout.u8('isInitialized'),\n  BufferLayout.u8('isApproved'),\n  publicKey('subscriptionPlanAccount'),\n  publicKey('tokenAccount'),\n  publicKey('owner'),\n  uint64('cycleStart'),\n  uint64('subscriptionTimeframe'),\n  uint64('maxAmount'),\n  uint64('withdrawnAmount'),\n]);\n\nexport function parseSubscriptionData(data: Buffer): ISubscriptionRecord {\n  const accountInfo = SubscriptionLayout.decode(data);\n  accountInfo.isInitialized = accountInfo.isInitialized !== 0;\n  accountInfo.isApproved = accountInfo.isApproved !== 0;\n  accountInfo.subscriptionPlanAccount = new PublicKey(\n    accountInfo.subscriptionPlanAccount,\n  );\n  accountInfo.tokenAccount = new PublicKey(accountInfo.tokenAccount);\n  accountInfo.owner = new PublicKey(accountInfo.owner);\n  accountInfo.cycleStart = u64.fromBuffer(accountInfo.cycleStart);\n  accountInfo.subscriptionTimeframe = u64.fromBuffer(\n    accountInfo.subscriptionTimeframe,\n  );\n  accountInfo.maxAmount = u64.fromBuffer(accountInfo.maxAmount);\n  accountInfo.withdrawnAmount = u64.fromBuffer(accountInfo.withdrawnAmount);\n\n  return accountInfo;\n}\n","import React, { ButtonHTMLAttributes, FC } from 'react';\n\nimport { styled } from '@linaria/react';\nimport classNames from 'classnames';\n\nconst ButtonStyled = styled.button`\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n\n  padding: 8px 11px;\n\n  font-size: 14px;\n  font-weight: 500;\n  line-height: 22px;\n\n  border-radius: 5px;\n  transition: opacity 200ms linear 0s, background-color 200ms linear 0s,\n    box-shadow 200ms linear 0s, color 200ms linear 0s;\n\n  outline: 0;\n  cursor: pointer;\n\n  &.primary {\n    color: #fff;\n\n    background-color: rgb(15, 111, 222);\n    box-shadow: rgb(19 45 74 / 12%) 0 0 0 0, rgb(0 0 0 / 20%) 0 2px 4px -2px;\n  }\n\n  &.hollow {\n    color: #696969;\n\n    background: #fff;\n  }\n\n  &:hover {\n    opacity: 0.9;\n  }\n\n  &:disabled {\n    opacity: 1;\n    background: #a3a5ba;\n    cursor: not-allowed;\n  }\n`;\n\ninterface Props {\n  primary?: boolean;\n  hollow?: boolean;\n}\n\nexport const Button: FC<Props & ButtonHTMLAttributes<HTMLButtonElement>> = ({\n  primary,\n  hollow,\n  disabled,\n  onClick,\n  children,\n  className,\n}) => {\n  return (\n    <ButtonStyled\n      disabled={disabled}\n      className={classNames(className, { primary, hollow })}\n      onClick={onClick}\n    >\n      {children}\n    </ButtonStyled>\n  );\n};\n","export const sleep: (ms: number) => Promise<void> = (ms: number) =>\n  new Promise((resolve) => setTimeout(resolve, ms));\n\nexport function shortAddress(address: string) {\n  return `${address.slice(0, 4)}…${address.slice(-4)}`;\n}\n","import React, { FC } from 'react';\n\nimport { styled } from '@linaria/react';\nimport { useStore } from 'effector-react';\nimport { Link } from 'react-router-dom';\nimport { $cluster, $connected, changeCluster } from 'models/wallet';\nimport { Select, SelectValueType } from 'components/ui/Select';\nimport { Button } from 'components/ui/Button';\nimport { connectAndCreateClicked } from 'pages/home/model';\nimport { MainContainer } from '../MainContainer';\nimport { ExtendedCluster } from '../../../types/custom';\nimport logoImg from './logo.png';\n\nconst Wrapper = styled.div`\n  display: flex;\n  align-items: center;\n\n  height: 64px;\n\n  background: #fff;\n  box-shadow: inset 0 -1px #eaeaea;\n`;\n\nconst Container = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\n\nconst Logo = styled.div`\n  width: 92px;\n  height: 39px;\n\n  background: url('${logoImg}') no-repeat 50% 50%;\n  background-size: 92px 39px;\n`;\n\nconst Right = styled.div`\n  display: flex;\n\n  & > :not(:last-child) {\n    margin-right: 16px;\n  }\n`;\n\ninterface Props {\n  showConnect?: boolean;\n}\n\nexport const Header: FC<Props> = ({ showConnect }) => {\n  const cluster = useStore($cluster);\n  const connected = useStore($connected);\n\n  const handleClusterChange = (cluster: SelectValueType) => {\n    changeCluster(cluster as ExtendedCluster);\n  };\n\n  return (\n    <Wrapper>\n      <MainContainer>\n        <Container>\n          <Link to=\"/\">\n            <Logo />\n          </Link>\n          <Right>\n            <Select\n              placeholder=\"Choose network\"\n              selected={cluster}\n              items={[\n                { value: 'mainnet-beta' },\n                { value: 'testnet' },\n                { value: 'devnet' },\n                { value: 'localnet' },\n              ]}\n              onChange={handleClusterChange}\n            />\n            {showConnect ? (\n              <Button primary onClick={connectAndCreateClicked}>\n                {!connected ? 'Connect' : 'Sign In'}\n              </Button>\n            ) : null}\n          </Right>\n        </Container>\n      </MainContainer>\n    </Wrapper>\n  );\n};\n","import React, { FC } from 'react';\n\nimport { styled } from '@linaria/react';\n\nconst Wrapper = styled.div`\n  width: 100%;\n  max-width: 1000px;\n  margin: 0 auto;\n`;\n\ninterface Props {}\n\nexport const MainContainer: FC<Props> = ({ children }) => {\n  return <Wrapper>{children}</Wrapper>;\n};\n"],"sourceRoot":""}